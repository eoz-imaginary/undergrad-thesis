(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 9.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[     52017,       1207]
NotebookOptionsPosition[     48060,       1136]
NotebookOutlinePosition[     48444,       1153]
CellTagsIndexPosition[     48401,       1150]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Make a convex polyhedron. ", "Title",
 CellChangeTimes->{{3.604592400277894*^9, 3.604592442280909*^9}, {
  3.6161751893731203`*^9, 3.6161751921598873`*^9}, {3.616233081838628*^9, 
  3.6162330854373837`*^9}, {3.616277853093804*^9, 3.6162778655703363`*^9}, {
  3.616336865695582*^9, 3.61633687399676*^9}, {3.6288614342448673`*^9, 
  3.628861443051174*^9}, {3.628861654270495*^9, 3.6288616552346907`*^9}},
 Background->RGBColor[0.94, 0.91, 0.88]],

Cell["\<\
JOR 2Sep2018.
Reduced from more general code.\
\>", "Subtitle",
 CellChangeTimes->{{3.6045924160858583`*^9, 3.6045924271812363`*^9}, {
  3.616277869211132*^9, 3.616277885386209*^9}, {3.616336857033277*^9, 
  3.616336857421995*^9}, {3.628861450122208*^9, 3.628861482490938*^9}, {
  3.744920275645959*^9, 3.7449202968935537`*^9}},
 Background->RGBColor[
  0.94, 0.91, 0.88],ExpressionUUID->"804c97eb-a71d-423e-9bbf-1db4574b0322"],

Cell[TextData[{
 "Implementation of sphere.c as a source of convex polyh. \nThen uses convex \
hull code provided by TetGenLink. \nAnd some miscellaneous funcs.\nOutput \
data: ",
 StyleBox["verts3d, faces.",
  FontSlant->"Italic"]
}], "Text",
 CellChangeTimes->{{3.6045924160858583`*^9, 3.6045924271812363`*^9}, {
   3.6161754139452133`*^9, 3.616175497432034*^9}, {3.616175586776231*^9, 
   3.616175598760043*^9}, {3.616276272127399*^9, 3.6162763590569563`*^9}, {
   3.6162777704309053`*^9, 3.616277816002232*^9}, 3.628861496330647*^9, {
   3.645200508270604*^9, 3.645200523524143*^9}, {3.645200629328377*^9, 
   3.645200648367444*^9}, {3.6452006853140574`*^9, 3.645200691109973*^9}, {
   3.645200850610325*^9, 3.645200852858073*^9}, {3.645200917488963*^9, 
   3.6452009352206793`*^9}, {3.744920310271747*^9, 3.744920330701304*^9}, 
   3.744920875867901*^9},
 Background->RGBColor[
  0.94, 0.91, 0.88],ExpressionUUID->"2811374c-8e31-4c40-aee7-c324200a9a2c"],

Cell[BoxData[
 RowBox[{"Needs", "[", "\"\<TetGenLink`\>\"", "]"}]], "Input",
 CellLabel->
  "In[125]:=",ExpressionUUID->"6dfec787-e548-40b6-bd2c-a0be118bbc12"],

Cell[TextData[{
 "{verts3d,faces}=TetGenConvexHull[pts];\n",
 StyleBox["verts3d",
  FontWeight->"Bold",
  FontSlant->"Italic"],
 StyleBox[" ",
  FontWeight->"Bold"],
 ": 3d coordinates of vertices, into which all other structs index.\n",
 StyleBox["faces",
  FontWeight->"Bold",
  FontSlant->"Italic"],
 " : indices of faces of convex hull (of sphere.c)\n",
 StyleBox["faces",
  FontSlant->"Italic"],
 " modified to be in ccw order."
}], "Text",
 CellChangeTimes->{{3.6045924160858583`*^9, 3.6045924271812363`*^9}, {
   3.6161754139452133`*^9, 3.616175497432034*^9}, {3.616175586776231*^9, 
   3.616175598760043*^9}, {3.616276272127399*^9, 3.616276427841195*^9}, {
   3.616276460378522*^9, 3.616276748713953*^9}, {3.616276949771069*^9, 
   3.6162770180181017`*^9}, {3.616277067297262*^9, 3.616277085010401*^9}, {
   3.616277123476739*^9, 3.616277183906763*^9}, 3.616277245891262*^9, {
   3.61627746159027*^9, 3.6162774653301373`*^9}, {3.6163376661260443`*^9, 
   3.6163376899491787`*^9}, {3.616342824277733*^9, 3.616342843180018*^9}, {
   3.616874772037222*^9, 3.616874836779297*^9}, {3.628861507885683*^9, 
   3.6288615295310793`*^9}, 3.628861999244069*^9, {3.744920337213256*^9, 
   3.744920340524171*^9}},
 Background->RGBColor[
  0.94, 0.91, 0.88],ExpressionUUID->"0243a947-b443-4538-83cc-e9bc4ad82c43"],

Cell[TextData[{
 StyleBox["Globals",
  FontWeight->"Bold"],
 ":\n",
 StyleBox["pts, verts3d, faces.",
  FontSlant->"Italic"]
}], "Text",
 CellChangeTimes->{{3.6045924160858583`*^9, 3.6045924271812363`*^9}, {
   3.6161754139452133`*^9, 3.616175497432034*^9}, {3.616175586776231*^9, 
   3.616175598760043*^9}, {3.616276272127399*^9, 3.616276427841195*^9}, {
   3.616276460378522*^9, 3.616276748713953*^9}, {3.616276949771069*^9, 
   3.6162770180181017`*^9}, {3.616277067297262*^9, 3.616277085010401*^9}, {
   3.616277123476739*^9, 3.616277183906763*^9}, 3.616277245891262*^9, {
   3.61627746159027*^9, 3.6162774653301373`*^9}, {3.6163376661260443`*^9, 
   3.6163376899491787`*^9}, {3.616342824277733*^9, 3.616342843180018*^9}, {
   3.616874772037222*^9, 3.616874836779297*^9}, {3.628861507885683*^9, 
   3.6288615295310793`*^9}, {3.628862003042281*^9, 3.628862056281713*^9}, {
   3.6288630256433897`*^9, 3.628863026220688*^9}, {3.744920345644237*^9, 
   3.744920347178898*^9}},
 Background->RGBColor[
  0.94, 0.91, 0.88],ExpressionUUID->"af28bdcc-e10c-4877-b403-7ce6d3921187"],

Cell[TextData[{
 "RandSphere: {a,b,c}: x,y,z +- ranges\nRandom pts ",
 StyleBox["on surface",
  FontSlant->"Italic"],
 " of sphere/ellipsoid."
}], "Text",
 CellChangeTimes->{{3.6045924160858583`*^9, 3.6045924271812363`*^9}, {
   3.6161754139452133`*^9, 3.616175497432034*^9}, {3.616175586776231*^9, 
   3.616175598760043*^9}, {3.616276272127399*^9, 3.616276427841195*^9}, {
   3.616276460378522*^9, 3.616276748713953*^9}, {3.616276949771069*^9, 
   3.6162770180181017`*^9}, {3.616277067297262*^9, 3.616277085010401*^9}, {
   3.616277123476739*^9, 3.616277183906763*^9}, 3.616277245891262*^9, {
   3.61627746159027*^9, 3.6162774653301373`*^9}, {3.6163376661260443`*^9, 
   3.6163376899491787`*^9}, {3.616342824277733*^9, 3.616342843180018*^9}, {
   3.616874772037222*^9, 3.616874836779297*^9}, {3.628861507885683*^9, 
   3.6288615295310793`*^9}, {3.628862003042281*^9, 3.628862056281713*^9}, {
   3.6288630256433897`*^9, 3.628863026220688*^9}, {3.647263531724351*^9, 
   3.6472635693800163`*^9}, {3.647680100060884*^9, 3.647680123025318*^9}},
 Background->RGBColor[0.94, 0.91, 0.88]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"RandSphere", "[", 
    RowBox[{"n_", ",", 
     RowBox[{"a_:", "100"}], ",", 
     RowBox[{"b_:", "100"}], ",", 
     RowBox[{"c_:", "100"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "x", ",", "y", ",", "z", ",", "t", ",", "w", ",", "i", ",", "p", ",", 
       RowBox[{"pts", "=", 
        RowBox[{"{", "}"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{"debug", ",", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<{a,b,c}=\>\"", ",", 
          RowBox[{"{", 
           RowBox[{"a", ",", "b", ",", "c"}], "}"}]}], "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", "=", "1"}], ",", 
         RowBox[{"i", "\[LessEqual]", "n"}], ",", 
         RowBox[{"i", "++"}], ","}]}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"i", "=", "1"}], ",", 
        RowBox[{"i", "\[LessEqual]", "n"}], ",", 
        RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"z", "=", 
          RowBox[{"RandomReal", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"t", "=", 
          RowBox[{"RandomReal", "[", 
           RowBox[{"{", 
            RowBox[{"0", ",", 
             RowBox[{"2", "\[Pi]"}]}], "}"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"w", "=", 
          SqrtBox[
           RowBox[{"1", "-", 
            RowBox[{"z", "^", "2"}]}]]}], ";", "\[IndentingNewLine]", 
         RowBox[{"x", "=", 
          RowBox[{"w", " ", 
           RowBox[{"Cos", "[", "t", "]"}]}]}], ";", 
         RowBox[{"y", "=", 
          RowBox[{"w", " ", 
           RowBox[{"Sin", "[", "t", "]"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"p", "=", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"a", " ", "x"}], ",", " ", 
            RowBox[{"b", " ", "y"}], ",", " ", 
            RowBox[{"c", " ", "z"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{"debug1", ",", 
           RowBox[{"Print", "[", 
            RowBox[{"\"\<p=\>\"", ",", "p"}], "]"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"AppendTo", "[", 
          RowBox[{"pts", ",", "p"}], "]"}]}]}], "\[IndentingNewLine]", "]"}], 
      ";", 
      RowBox[{"(*", "Fori", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "pts", "]"}]}]}], "\[IndentingNewLine]", "]"}]}],
   ";"}]], "Input",
 CellChangeTimes->{{3.604592496698792*^9, 3.6045925317406597`*^9}, {
   3.6045926313334293`*^9, 3.604592822241541*^9}, {3.60459291814186*^9, 
   3.6045929463646317`*^9}, 3.604680822405055*^9, {3.6046811237705107`*^9, 
   3.604681172480083*^9}, {3.67739420882264*^9, 3.677394230724311*^9}, {
   3.677397591731703*^9, 3.6773975934342213`*^9}, {3.677499680062973*^9, 
   3.677499696303076*^9}, 3.693517554652337*^9, {3.7449203624706507`*^9, 
   3.74492036390096*^9}, {3.744920673664227*^9, 3.744920673797283*^9}},
 CellLabel->
  "In[126]:=",ExpressionUUID->"ee332a8c-45c2-41bd-92ac-73409a5341bd"],

Cell[TextData[{
 "Labeling funcs.\n",
 StyleBox["verts3d",
  FontSlant->"Italic"],
 " & ",
 StyleBox["faces",
  FontSlant->"Italic"],
 " are global, already computed.\n",
 StyleBox["fiup",
  FontSlant->"Italic"],
 " is list of faces indices, indices into ",
 StyleBox["faces",
  FontSlant->"Italic"],
 ". Here ",
 StyleBox["fiup",
  FontSlant->"Italic"],
 "\[Equal]",
 StyleBox["faces",
  FontSlant->"Italic"],
 "."
}], "Text",
 CellChangeTimes->{{3.5876766874771976`*^9, 3.58767669382759*^9}, {
  3.587676932725223*^9, 3.587676935310511*^9}, {3.5880233842939463`*^9, 
  3.5880234811214027`*^9}, {3.588060758399602*^9, 3.588060764582789*^9}, {
  3.588060840179935*^9, 3.588060959455077*^9}, {3.58806100037446*^9, 
  3.5880610158134212`*^9}, {3.604593526209601*^9, 3.604593540265007*^9}, {
  3.628861574252883*^9, 3.628861576930799*^9}, {3.6557384811292953`*^9, 
  3.655738508416296*^9}, {3.655738624028365*^9, 3.6557386421461143`*^9}, {
  3.655738742469966*^9, 3.655738756077178*^9}, {3.744920394059197*^9, 
  3.744920415530011*^9}},
 Background->RGBColor[
  0.94, 0.91, 0.88],ExpressionUUID->"a35422a9-abf7-4e53-8796-b47672062608"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"TriLabels", "[", "fiup_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"fi", ",", "nf", ",", "v123", ",", "p", ",", 
       RowBox[{"labels", "=", 
        RowBox[{"{", "}"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"nf", "=", 
       RowBox[{"Length", "[", "faces", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"fi", "=", "1"}], ",", 
        RowBox[{"fi", "\[LessEqual]", "nf"}], ",", 
        RowBox[{"fi", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"MemberQ", "[", 
            RowBox[{"fiup", ",", "fi"}], "]"}], ",", 
           RowBox[{"(*", 
            RowBox[{"only", " ", "if", " ", "in", " ", "list"}], "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"v123", "=", 
             RowBox[{"verts3d", "\[LeftDoubleBracket]", 
              RowBox[{
              "faces", "\[LeftDoubleBracket]", "fi", 
               "\[RightDoubleBracket]"}], "\[RightDoubleBracket]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"p", "=", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"1", "/", "3"}], ")"}], 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "v123", "\[LeftDoubleBracket]", "1", 
                 "\[RightDoubleBracket]"}], "+", 
                RowBox[{
                "v123", "\[LeftDoubleBracket]", "2", 
                 "\[RightDoubleBracket]"}], "+", 
                RowBox[{
                "v123", "\[LeftDoubleBracket]", "3", 
                 "\[RightDoubleBracket]"}]}], ")"}]}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"AppendTo", "[", 
             RowBox[{"labels", ",", 
              RowBox[{"Text", "[", 
               RowBox[{"fi", ",", "p"}], "]"}]}], "\[IndentingNewLine]", 
             "]"}]}]}], 
          RowBox[{"(*", "If", "*)"}], "\[IndentingNewLine]", "]"}], ";"}]}], 
       RowBox[{"(*", "Iffiup", "*)"}], "\[IndentingNewLine]", "]"}], ";", 
      RowBox[{"(*", "Forf", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "labels", "]"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TriNormals", "[", "fiup_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"fi", ",", "nf", ",", "v123", ",", "p", ",", "nvec", ",", 
       RowBox[{"nvecs", "=", 
        RowBox[{"{", "}"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"nf", "=", 
       RowBox[{"Length", "[", "faces", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"fi", "=", "1"}], ",", 
        RowBox[{"fi", "\[LessEqual]", "nf"}], ",", 
        RowBox[{"fi", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"MemberQ", "[", 
            RowBox[{"bfaces", ",", "fi"}], "]"}], ",", 
           RowBox[{"(*", 
            RowBox[{
            "only", " ", "if", " ", "in", " ", "bfaces", " ", "list"}], 
            "*)"}], "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"v123", "=", 
             RowBox[{"verts3d", "\[LeftDoubleBracket]", 
              RowBox[{
              "faces", "\[LeftDoubleBracket]", "fi", 
               "\[RightDoubleBracket]"}], "\[RightDoubleBracket]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"p", "=", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"1", "/", "3"}], ")"}], 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "v123", "\[LeftDoubleBracket]", "1", 
                 "\[RightDoubleBracket]"}], "+", 
                RowBox[{
                "v123", "\[LeftDoubleBracket]", "2", 
                 "\[RightDoubleBracket]"}], "+", 
                RowBox[{
                "v123", "\[LeftDoubleBracket]", "3", 
                 "\[RightDoubleBracket]"}]}], ")"}]}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"nvec", "=", 
             RowBox[{"FaceNormal", "[", "fi", "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"AppendTo", "[", 
             RowBox[{"nvecs", ",", 
              RowBox[{"Arrow", "[", 
               RowBox[{"{", 
                RowBox[{"p", ",", 
                 RowBox[{"p", "+", 
                  RowBox[{"0.25", " ", "nvec"}]}]}], "}"}], "]"}]}], 
             RowBox[{"(*", "Shorten", "*)"}], "\[IndentingNewLine]", 
             "]"}]}]}], 
          RowBox[{"(*", "If", "*)"}], "\[IndentingNewLine]", "]"}], ";"}]}], 
       RowBox[{"(*", "Iffiup", "*)"}], "\[IndentingNewLine]", "]"}], ";", 
      RowBox[{"(*", "Forf", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "nvecs", "]"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"VertsLabels", "[", "fiup_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"nv", ",", "vi", ",", 
       RowBox[{"labels", "=", 
        RowBox[{"{", "}"}]}], ",", "fup", ",", "viup"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"fup", "=", 
       RowBox[{
       "faces", "\[LeftDoubleBracket]", "fiup", "\[RightDoubleBracket]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"viup", "=", 
       RowBox[{"Union", "[", 
        RowBox[{"Flatten", "[", "fup", "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"nv", "=", 
       RowBox[{"Length", "[", "verts3d", "]"}]}], ";", "\[IndentingNewLine]", 
      
      RowBox[{"If", "[", 
       RowBox[{"debug", ",", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<VertsLabels:#{verts3d,viup}=\>\"", ",", 
          RowBox[{"{", 
           RowBox[{"nv", ",", 
            RowBox[{"Length", "[", "viup", "]"}]}], "}"}]}], "]"}]}], "]"}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"vi", "=", "1"}], ",", 
        RowBox[{"vi", "\[LessEqual]", "nv"}], ",", 
        RowBox[{"vi", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"MemberQ", "[", 
           RowBox[{"viup", ",", "vi"}], "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"labels", ",", 
            RowBox[{"Text", "[", 
             RowBox[{"vi", ",", 
              RowBox[{
              "verts3d", "\[LeftDoubleBracket]", "vi", 
               "\[RightDoubleBracket]"}]}], "]"}]}], "]"}]}], 
         "\[IndentingNewLine]", "]"}]}], 
       RowBox[{"(*", "If", "*)"}], "\[IndentingNewLine]", "]"}], ";", 
      RowBox[{"(*", "Forf", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "labels", "]"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.604595675921081*^9, 3.604595781093466*^9}, {
  3.6046815273780413`*^9, 3.604681591582554*^9}, {3.6162327538669863`*^9, 
  3.616232786910832*^9}, {3.616233074112694*^9, 3.616233074141025*^9}, {
  3.616935455972268*^9, 3.61693553160469*^9}, {3.655738396831787*^9, 
  3.655738431284566*^9}, {3.655738472628533*^9, 3.655738477947657*^9}, {
  3.655738680937561*^9, 3.655738738022985*^9}, {3.655738776244813*^9, 
  3.655738884263937*^9}, {3.6557391779659224`*^9, 3.65573917888332*^9}, {
  3.6557395486932783`*^9, 3.65573960368196*^9}, {3.655739670847477*^9, 
  3.655739671485404*^9}, {3.675690256471826*^9, 3.675690273334988*^9}, {
  3.702895045080246*^9, 3.702895250225157*^9}, {3.702895287920092*^9, 
  3.702895299845765*^9}, {3.704724098400011*^9, 3.704724130778852*^9}, {
  3.704725558979002*^9, 3.7047255642254343`*^9}, {3.744920447058622*^9, 
  3.744920448769681*^9}},
 CellLabel->
  "In[127]:=",ExpressionUUID->"e0404b75-6e68-47f5-ae13-44e1dd11356e"],

Cell[TextData[{
 "Here is the key computation step. Leave {",
 StyleBox["verts3d,faces",
  FontSlant->"Italic"],
 "} global.\nInput: ",
 StyleBox["pts",
  FontSlant->"Italic"],
 ".\nCode removes any ",
 StyleBox["pts",
  FontSlant->"Italic"],
 " that may be inside the hull."
}], "Text",
 CellChangeTimes->{{3.616277925493144*^9, 3.6162779785067453`*^9}, {
  3.628862245243621*^9, 3.6288622458104887`*^9}, {3.647334777885377*^9, 
  3.647334824454322*^9}, {3.744920531117098*^9, 3.744920544099907*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"de462047-8eb9-4782-bf55-84a0eef67bd9"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"CreatePolyh", "[", "pts_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"g", ",", "vinds", ",", "vinside"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"verts3d", ",", "faces"}], "}"}], "=", 
       RowBox[{"TetGenConvexHull", "[", "pts", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<#verts3d=\>\"", ",", 
        RowBox[{"Length", "[", "verts3d", "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<#faces=\>\"", ",", 
        RowBox[{"Length", "[", "faces", "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"vinds", "=", 
       RowBox[{"Union", "[", 
        RowBox[{"Flatten", "[", "faces", "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<#vertsinds=\>\"", ",", 
        RowBox[{"Length", "[", "vinds", "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"vinside", "=", 
       RowBox[{"Select", "[", 
        RowBox[{
         RowBox[{"Range", "[", 
          RowBox[{"1", ",", 
           RowBox[{"Length", "[", "verts3d", "]"}]}], "]"}], ",", 
         RowBox[{
          RowBox[{"!", 
           RowBox[{"MemberQ", "[", 
            RowBox[{"vinds", ",", "#"}], "]"}]}], "&"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<vinside=\>\"", ",", "vinside"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "vinside", "]"}], ">", "0"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"vinside", "=", 
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"{", "#", "}"}], "&"}], ",", "vinside"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Print", "[", 
          RowBox[{"\"\<vinside=\>\"", ",", "vinside"}], "]"}], ";", 
         RowBox[{"(*", 
          RowBox[{"wrap", " ", "for", " ", 
           RowBox[{"Delete", "[", "]"}]}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"verts3d", "=", 
          RowBox[{"Delete", "[", 
           RowBox[{"verts3d", ",", "vinside"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Print", "[", 
          RowBox[{"\"\<#verts3d=\>\"", ",", 
           RowBox[{"Length", "[", "verts3d", "]"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", "Recompute", "*)"}], "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"verts3d", ",", "faces"}], "}"}], "=", 
          RowBox[{"TetGenConvexHull", "[", "verts3d", "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Print", "[", 
          RowBox[{"\"\<#verts3d=\>\"", ",", 
           RowBox[{"Length", "[", "verts3d", "]"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Print", "[", 
          RowBox[{"\"\<#faces=\>\"", ",", 
           RowBox[{"Length", "[", "faces", "]"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"vinds", "=", 
          RowBox[{"Union", "[", 
           RowBox[{"Flatten", "[", "faces", "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Print", "[", 
          RowBox[{"\"\<#vertsinds=\>\"", ",", 
           RowBox[{"Length", "[", "vinds", "]"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", "verts3d", "]"}], "!=", 
            RowBox[{"Length", "[", "vinds", "]"}]}], ",", 
           RowBox[{"Abort", "[", "]"}]}], "]"}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", 
      RowBox[{"(*", "If", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "Reverse", " ", "all", " ", "faces", " ", "to", " ", "be", " ", 
        "ccw"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"faces", "=", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Reverse", "[", "#", "]"}], "&"}], ",", "faces"}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"g", "=", 
       RowBox[{"Graphics3D", "[", 
        RowBox[{
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Opacity", "[", "0.5", "]"}], ",", 
             RowBox[{"GraphicsComplex", "[", 
              RowBox[{"verts3d", ",", 
               RowBox[{"Polygon", "[", "faces", "]"}]}], "]"}]}], "}"}], ",", 
           
           RowBox[{"{", 
            RowBox[{"Blue", ",", 
             RowBox[{"VertsLabels", "[", 
              RowBox[{"Range", "[", 
               RowBox[{"Length", "[", "faces", "]"}], "]"}], "]"}]}], "}"}], 
           ",", 
           RowBox[{"{", 
            RowBox[{"Red", ",", 
             RowBox[{"TriLabels", "[", 
              RowBox[{"Range", "[", 
               RowBox[{"Length", "[", "faces", "]"}], "]"}], "]"}]}], "}"}], 
           ",", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"Green", ",", 
             RowBox[{"Point", "[", "pts", "]"}]}], "}"}]}], 
          "\[IndentingNewLine]", "}"}], "\[IndentingNewLine]", 
         RowBox[{"(*", "\[IndentingNewLine]", 
          RowBox[{",", 
           RowBox[{"Axes", "\[Rule]", "True"}], "\[IndentingNewLine]", ",", 
           RowBox[{"AxesLabel", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"\"\<x\>\"", ",", "\"\<y\>\"", ",", "\"\<z\>\""}], 
             "}"}]}]}], "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
         ",", 
         RowBox[{"Boxed", "\[Rule]", "False"}], "\[IndentingNewLine]", ",", 
         RowBox[{"ImageSize", "\[Rule]", "Small"}]}], "\[IndentingNewLine]", 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "g", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.5886130026102324`*^9, 3.588613010451009*^9}, 
   3.588613058320485*^9, 3.590010388640712*^9, {3.590011903851933*^9, 
   3.590011906116435*^9}, 3.590701622248424*^9, 3.594830387015471*^9, {
   3.604593564961327*^9, 3.6045935655238857`*^9}, {3.616232166032303*^9, 
   3.616232204224009*^9}, 3.6162322354637327`*^9, {3.616232735681438*^9, 
   3.616232745046781*^9}, {3.628861714390416*^9, 3.6288617225816813`*^9}, {
   3.628862444960907*^9, 3.628862445889822*^9}, {3.629209717361539*^9, 
   3.629209721374751*^9}, {3.629209905111391*^9, 3.6292099066122217`*^9}, {
   3.629210234279188*^9, 3.6292102567718287`*^9}, {3.629210287261489*^9, 
   3.629210307980152*^9}, {3.6292104684391212`*^9, 3.62921049637183*^9}, {
   3.629210538525507*^9, 3.6292105618039427`*^9}, {3.6292106230929527`*^9, 
   3.6292107125384693`*^9}, {3.6292107613445263`*^9, 3.629210780629006*^9}, {
   3.629210813816773*^9, 3.629210833541031*^9}, {3.646840641653789*^9, 
   3.646840645861568*^9}, {3.646840759222818*^9, 3.646840761408402*^9}, {
   3.6468419738503428`*^9, 3.6468419787764072`*^9}, {3.646842070399122*^9, 
   3.6468420731493053`*^9}, {3.646842190428858*^9, 3.646842202125903*^9}, {
   3.646842259321883*^9, 3.6468422627588367`*^9}, {3.6468423524167843`*^9, 
   3.64684235497828*^9}, {3.6469118870052*^9, 3.646911889083338*^9}, {
   3.646912051161435*^9, 3.646912053770993*^9}, {3.647252394305327*^9, 
   3.647252396985528*^9}, {3.647273654579397*^9, 3.647273657088904*^9}, {
   3.647334731405558*^9, 3.6473347682061462`*^9}, {3.647334802265263*^9, 
   3.6473348045038023`*^9}, {3.64916323296148*^9, 3.649163263247735*^9}, {
   3.649163968761606*^9, 3.649163975848566*^9}, {3.6491712879790773`*^9, 
   3.649171291737081*^9}, {3.649346871388075*^9, 3.64934687478188*^9}, {
   3.64940919068501*^9, 3.649409194451208*^9}, {3.6494093217004547`*^9, 
   3.649409325067225*^9}, 3.6557385336007137`*^9, {3.655738924617136*^9, 
   3.655738944657179*^9}, {3.744920559700774*^9, 3.744920577836384*^9}, {
   3.763742349320483*^9, 3.763742350395442*^9}},
 CellLabel->
  "In[130]:=",ExpressionUUID->"bb59d684-bfd6-4057-bbcf-337822f3a6c2"],

Cell["Above here: funcs. Below: evals.", "Text",
 CellChangeTimes->{{3.616277925493144*^9, 3.6162779785067453`*^9}, {
  3.628862256515635*^9, 3.6288622723218937`*^9}},
 Background->RGBColor[0.87, 0.94, 1]],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"debug", "=", "False"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SeedRandom", "[", "2", "]"}], ";", 
  RowBox[{"debug", "=", "False"}], ";", 
  RowBox[{"pts", "=", 
   RowBox[{"RandSphere", "[", 
    RowBox[{"10", ",", "2", ",", "1", ",", "1"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.628979283367775*^9, 3.6289792890954313`*^9}, {
   3.6289793564737673`*^9, 3.628979356908472*^9}, {3.628981315251851*^9, 
   3.6289813326918077`*^9}, {3.6292007023571873`*^9, 3.6292007565278673`*^9}, 
   3.629200805674583*^9, 3.6292008369984617`*^9, {3.629200952376449*^9, 
   3.629201006293792*^9}, {3.6292011039367533`*^9, 3.629201130494062*^9}, {
   3.629201363882255*^9, 3.629201371669963*^9}, {3.6292016127948427`*^9, 
   3.6292016203659286`*^9}, {3.62920724523431*^9, 3.6292073409421873`*^9}, {
   3.629207807079874*^9, 3.629207842873501*^9}, {3.629208018206444*^9, 
   3.629208031271997*^9}, {3.629208176216378*^9, 3.6292082321636753`*^9}, {
   3.6292084883217697`*^9, 3.6292085134769907`*^9}, {3.6292086060243797`*^9, 
   3.6292086437415752`*^9}, {3.629208738591736*^9, 3.6292087636852407`*^9}, {
   3.629211351357132*^9, 3.629211398344698*^9}, {3.629296203569594*^9, 
   3.6292962377636023`*^9}, {3.629298672046055*^9, 3.629298683298339*^9}, {
   3.6292990284450502`*^9, 3.629299041042839*^9}, {3.629399168661285*^9, 
   3.629399192142037*^9}, {3.6294818116528683`*^9, 3.6294818146416683`*^9}, 
   3.629623253869986*^9, {3.645542174456377*^9, 3.6455421847138767`*^9}, {
   3.645542734667119*^9, 3.645542742760927*^9}, {3.6457821576743097`*^9, 
   3.645782186289064*^9}, {3.645809401290227*^9, 3.645809407661243*^9}, {
   3.6461381713841963`*^9, 3.6461381744375877`*^9}, {3.646227591845148*^9, 
   3.6462276009834013`*^9}, 3.646648636419572*^9, {3.647262895421076*^9, 
   3.647262926548849*^9}, {3.647263588927446*^9, 3.647263594862805*^9}, {
   3.647274231335866*^9, 3.6472742372457*^9}, {3.6473346769230423`*^9, 
   3.647334686082439*^9}, {3.6473352103723087`*^9, 3.647335215803104*^9}, {
   3.744920457505272*^9, 3.744920469656136*^9}, 3.7449205054270983`*^9, {
   3.744920602883088*^9, 3.744920605449299*^9}, {3.744920651638583*^9, 
   3.7449206526770077`*^9}, {3.7449206844762917`*^9, 3.74492073262331*^9}, {
   3.744920926307864*^9, 3.744920934415415*^9}},
 CellLabel->
  "In[131]:=",ExpressionUUID->"9e2b9a3f-fa87-4f53-9139-94f756c32bda"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Graphics3D", "[", 
  RowBox[{
   RowBox[{"Point", "[", "pts", "]"}], "\[IndentingNewLine]", ",", 
   RowBox[{"Axes", "\[Rule]", "True"}], "\[IndentingNewLine]", ",", 
   RowBox[{"AxesLabel", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"\"\<x\>\"", ",", "\"\<y\>\"", ",", "\"\<z\>\""}], "}"}]}], 
   "\[IndentingNewLine]", ",", 
   RowBox[{"ImageSize", "\[Rule]", "Tiny"}]}], "\[IndentingNewLine]", 
  "]"}]], "Input",
 CellChangeTimes->{{3.604593383333301*^9, 3.604593428086405*^9}, {
   3.604594762100541*^9, 3.6045947677781878`*^9}, 3.604680854677971*^9, {
   3.604681030114036*^9, 3.604681049184822*^9}, {3.6162759848624268`*^9, 
   3.616275987731593*^9}, {3.629195180616284*^9, 3.629195189610441*^9}, {
   3.744920807018672*^9, 3.74492084948353*^9}},
 CellLabel->
  "In[133]:=",ExpressionUUID->"30ae440c-6701-452b-a162-972fd7b0d5d0"],

Cell[BoxData[
 Graphics3DBox[
  Point3DBox[{{1.3843824315066975`, 0.5686028401505108, 
   0.44447961821288695`}, {-1.9468747906786323`, -0.22132852381015644`, \
-0.05859455523361223}, {-0.5376107778940128, 0.9487199684634959, 
   0.16635529541217453`}, {-1.1946793995285403`, -0.44124724177060887`, \
-0.6696910890219172}, {0.22790172781235443`, -0.8535273266411705, 
   0.5084351515108025}, {1.6425845749446293`, 0.12273912798259565`, 
   0.5571481714953079}, {1.0667088420380166`, -0.025307051922532305`, 
   0.8455132256224434}, {1.8326008602834145`, 
   0.26623932191324523`, -0.2991824613664673}, {-1.3343032691133065`, \
-0.7449169786770292, 0.0027187105532253675`}, {-1.4764249572492054`, 
   0.611678005165793, 0.2844158124987368}}],
  Axes->True,
  AxesLabel->{
    FormBox["\"x\"", TraditionalForm], 
    FormBox["\"y\"", TraditionalForm], 
    FormBox["\"z\"", TraditionalForm]},
  ImageSize->Tiny]], "Output",
 CellChangeTimes->{{3.744920809600284*^9, 3.744920850719605*^9}, 
   3.744920936510378*^9, 3.747414984882703*^9, 3.747417112737851*^9, 
   3.7480743574150248`*^9, 3.7480745870259*^9, 3.750711998253531*^9, 
   3.7637423057274723`*^9, 3.763742362831985*^9},
 CellLabel->
  "Out[133]=",ExpressionUUID->"0972617a-0f3e-4ce2-a1ea-85700aca0445"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"gpolyh", "=", 
  RowBox[{"CreatePolyh", "[", "pts", "]"}]}]], "Input",
 CellChangeTimes->{
  3.647334957000928*^9, {3.647335201146305*^9, 3.647335204170453*^9}, 
   3.744920583375465*^9, {3.763742357021833*^9, 3.763742359667349*^9}},
 CellLabel->
  "In[134]:=",ExpressionUUID->"f18b059a-eeb9-46c2-baed-87c6ff29ebc8"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"#verts3d=\"\>", "\[InvisibleSpace]", "10"}],
  SequenceForm["#verts3d=", 10],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.7449206337838717`*^9, {3.744920691846147*^9, 3.74492073866747*^9}, {
   3.744920809761726*^9, 3.744920858596262*^9}, 3.744920936590398*^9, 
   3.7474149849262533`*^9, 3.7474171128355227`*^9, 3.7480743574675617`*^9, 
   3.7480745871141567`*^9, 3.750711998296937*^9, 3.763742306024518*^9, 
   3.763742362915601*^9},
 CellLabel->
  "During evaluation of \
In[134]:=",ExpressionUUID->"14074905-08b5-4dd0-a52a-7b8dc29393c1"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"#faces=\"\>", "\[InvisibleSpace]", "16"}],
  SequenceForm["#faces=", 16],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.7449206337838717`*^9, {3.744920691846147*^9, 3.74492073866747*^9}, {
   3.744920809761726*^9, 3.744920858596262*^9}, 3.744920936590398*^9, 
   3.7474149849262533`*^9, 3.7474171128355227`*^9, 3.7480743574675617`*^9, 
   3.7480745871141567`*^9, 3.750711998296937*^9, 3.763742306024518*^9, 
   3.76374236292933*^9},
 CellLabel->
  "During evaluation of \
In[134]:=",ExpressionUUID->"135c1dae-181d-4ef9-8e71-0cd37af80a73"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"#vertsinds=\"\>", "\[InvisibleSpace]", "10"}],
  SequenceForm["#vertsinds=", 10],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.7449206337838717`*^9, {3.744920691846147*^9, 3.74492073866747*^9}, {
   3.744920809761726*^9, 3.744920858596262*^9}, 3.744920936590398*^9, 
   3.7474149849262533`*^9, 3.7474171128355227`*^9, 3.7480743574675617`*^9, 
   3.7480745871141567`*^9, 3.750711998296937*^9, 3.763742306024518*^9, 
   3.76374236294354*^9},
 CellLabel->
  "During evaluation of \
In[134]:=",ExpressionUUID->"c3381e11-1eda-4ed3-8a34-f56248defe68"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"vinside=\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", "}"}]}],
  SequenceForm["vinside=", {}],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.7449206337838717`*^9, {3.744920691846147*^9, 3.74492073866747*^9}, {
   3.744920809761726*^9, 3.744920858596262*^9}, 3.744920936590398*^9, 
   3.7474149849262533`*^9, 3.7474171128355227`*^9, 3.7480743574675617`*^9, 
   3.7480745871141567`*^9, 3.750711998296937*^9, 3.763742306024518*^9, 
   3.763742362953669*^9},
 CellLabel->
  "During evaluation of \
In[134]:=",ExpressionUUID->"03113baa-9778-493e-8c99-642b9c7ed3ec"]
}, Open  ]],

Cell[BoxData[
 Graphics3DBox[{
   {Opacity[0.5], 
    GraphicsComplex3DBox[{{1.3843824315066975`, 0.5686028401505108, 
     0.44447961821288695`}, {-1.9468747906786323`, -0.22132852381015644`, \
-0.05859455523361223}, {-0.5376107778940128, 0.9487199684634959, 
     0.16635529541217453`}, {-1.1946793995285403`, -0.44124724177060887`, \
-0.6696910890219172}, {0.22790172781235443`, -0.8535273266411705, 
     0.5084351515108025}, {1.6425845749446293`, 0.12273912798259565`, 
     0.5571481714953079}, {1.0667088420380166`, -0.025307051922532305`, 
     0.8455132256224434}, {1.8326008602834145`, 
     0.26623932191324523`, -0.2991824613664673}, {-1.3343032691133065`, \
-0.7449169786770292, 0.0027187105532253675`}, {-1.4764249572492054`, 
     0.611678005165793, 0.2844158124987368}}, 
     Polygon3DBox[{{10, 4, 2}, {4, 9, 2}, {8, 4, 3}, {5, 4, 8}, {7, 5, 6}, {6,
       5, 8}, {8, 1, 6}, {6, 1, 7}, {3, 4, 10}, {10, 2, 5}, {2, 9, 5}, {8, 3, 
      1}, {10, 5, 7}, {7, 3, 10}, {1, 3, 7}, {5, 9, 4}}]]}, 
   {RGBColor[0, 0, 1], 
    Text3DBox["1", {1.3843824315066975`, 0.5686028401505108, 
     0.44447961821288695`}], 
    Text3DBox[
     "2", {-1.9468747906786323`, -0.22132852381015644`, \
-0.05859455523361223}], 
    Text3DBox["3", {-0.5376107778940128, 0.9487199684634959, 
     0.16635529541217453`}], 
    Text3DBox[
     "4", {-1.1946793995285403`, -0.44124724177060887`, -0.6696910890219172}],
     Text3DBox["5", {0.22790172781235443`, -0.8535273266411705, 
     0.5084351515108025}], 
    Text3DBox["6", {1.6425845749446293`, 0.12273912798259565`, 
     0.5571481714953079}], 
    Text3DBox["7", {1.0667088420380166`, -0.025307051922532305`, 
     0.8455132256224434}], 
    Text3DBox["8", {1.8326008602834145`, 
     0.26623932191324523`, -0.2991824613664673}], 
    Text3DBox["9", {-1.3343032691133065`, -0.7449169786770292, 
     0.0027187105532253675`}], 
    Text3DBox["10", {-1.4764249572492054`, 0.611678005165793, 
     0.2844158124987368}]}, 
   {RGBColor[1, 0, 0], 
    Text3DBox[
     "1", {-1.5393263824854593`, -0.016965920138324115`, \
-0.14795661058559753`}], 
    Text3DBox[
     "2", {-1.4919524864401599`, -0.4691642480859315, -0.2418556445674347}], 
    Text3DBox["3", {0.033436894286953844`, 
     0.2579040162020441, -0.26750608499206996`}], 
    Text3DBox["4", {
     0.28860772952240954`, -0.342845082166178, -0.15347946629252732`}], 
    Text3DBox["5", {0.9790650482650001, -0.2520317501937024, 
     0.6370321828761846}], 
    Text3DBox["6", {1.2343623876801326`, -0.1548496255817765, 
     0.25546695387988105`}], 
    Text3DBox["7", {1.619855955578247, 0.31919376334878385`, 
     0.23414844278057584`}], 
    Text3DBox["8", {1.3645586161631142`, 0.22201163873685803`, 
     0.6157136717768794}], 
    Text3DBox["9", {-1.0695717115572527`, 
     0.3730502439528933, -0.07297332703700195}], 
    Text3DBox["10", {-1.0651326733718278`, -0.154392615095178, 
     0.24475213625864237`}], 
    Text3DBox["11", {-1.0177587773265282`, -0.6065909430427854, 
     0.1508531022768052}], 
    Text3DBox["12", {0.8931241712986997, 0.5945207101757506, 
     0.10388415075286472`}], 
    Text3DBox["13", {-0.06060479579961142, -0.08905212446596994, 
     0.5461213965439942}], 
    Text3DBox["14", {-0.3157756310350671, 0.5116969739022521, 
     0.43209477784445155`}], 
    Text3DBox["15", {0.637826831883567, 0.4973385855638247, 
     0.48544937974916824`}], 
    Text3DBox[
     "16", {-0.7670269802764974, -0.6798971823629361, -0.05284574231929643}]}, 
   {RGBColor[0, 1, 0], 
    Point3DBox[{{1.3843824315066975`, 0.5686028401505108, 
     0.44447961821288695`}, {-1.9468747906786323`, -0.22132852381015644`, \
-0.05859455523361223}, {-0.5376107778940128, 0.9487199684634959, 
     0.16635529541217453`}, {-1.1946793995285403`, -0.44124724177060887`, \
-0.6696910890219172}, {0.22790172781235443`, -0.8535273266411705, 
     0.5084351515108025}, {1.6425845749446293`, 0.12273912798259565`, 
     0.5571481714953079}, {1.0667088420380166`, -0.025307051922532305`, 
     0.8455132256224434}, {1.8326008602834145`, 
     0.26623932191324523`, -0.2991824613664673}, {-1.3343032691133065`, \
-0.7449169786770292, 0.0027187105532253675`}, {-1.4764249572492054`, 
     0.611678005165793, 0.2844158124987368}}]}},
  Boxed->False,
  ImageSize->Small,
  ViewPoint->{1.3, -2.4, 2.},
  ViewVertical->{0., 0., 1.}]], "Output",
 CellChangeTimes->{3.7637423630362864`*^9},
 CellLabel->
  "Out[134]=",ExpressionUUID->"a39df94f-35ea-408f-8ae0-530fce8d2208"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Initialize some vars that are not relevant for a closed polyh.\
\>", "Subsection",
 CellChangeTimes->{{3.747417624947546*^9, 
  3.747417645936819*^9}},ExpressionUUID->"c550ef75-3ac0-469a-abaf-\
4b2359a362e8"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"fiup", "=", 
   RowBox[{"Range", "[", 
    RowBox[{"Length", "@", "faces"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"centi", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bverts", "=", 
   RowBox[{"{", "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.747415068157707*^9, 3.7474150818749247`*^9}, {
  3.747415144051072*^9, 3.747415163047688*^9}, {3.7474173256313963`*^9, 
  3.747417332797121*^9}, {3.747417406102992*^9, 3.747417408405884*^9}},
 CellLabel->
  "In[135]:=",ExpressionUUID->"d9a72e07-350c-42cb-8a21-12527ce65f31"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"DoPolyhDS", "[", "]"}]], "Input",
 CellChangeTimes->{{3.747415025582389*^9, 3.747415035076809*^9}, 
   3.747415276032311*^9},
 CellLabel->
  "In[138]:=",ExpressionUUID->"bd073e67-df42-4d7a-b088-8638c8a06800"],

Cell[BoxData[
 RowBox[{"DoPolyhDS", "[", "]"}]], "Output",
 CellChangeTimes->{3.763742306723544*^9, 3.763742363147156*^9},
 CellLabel->
  "Out[138]=",ExpressionUUID->"8c6fe526-e486-4a71-b0c0-c299136ac2f6"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"PrintDS", "[", "True", "]"}]], "Input",
 CellChangeTimes->{{3.747417270608283*^9, 3.747417287318789*^9}},
 CellLabel->
  "In[139]:=",ExpressionUUID->"605d8bba-ceee-4cb0-91bd-0afe39c01983"],

Cell[BoxData[
 RowBox[{"PrintDS", "[", "True", "]"}]], "Output",
 CellChangeTimes->{3.763742306772999*^9, 3.7637423632131653`*^9},
 CellLabel->
  "Out[139]=",ExpressionUUID->"70630c18-bed7-438b-8a43-7283f156a33e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData["vadjccws"], "Input",
 CellChangeTimes->{{3.7479975716556873`*^9, 3.747997575651506*^9}},
 CellLabel->
  "In[140]:=",ExpressionUUID->"143f5456-681a-4a18-aba1-db4bbb4bd636"],

Cell[BoxData["vadjccws"], "Output",
 CellChangeTimes->{3.7479975771627817`*^9, 3.74807435799341*^9, 
  3.748074587746573*^9, 3.750711998674859*^9, 3.763742306805881*^9, 
  3.763742363276636*^9},
 CellLabel->
  "Out[140]=",ExpressionUUID->"acf587db-013a-42d2-be56-2d73eee2af34"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"faces", "[", 
  RowBox[{"[", "11", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.750712093565261*^9, 3.750712156102963*^9}},
 CellLabel->
  "In[141]:=",ExpressionUUID->"dc86b4aa-cbf4-4276-b063-5eb15d3bfdb0"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"2", ",", "9", ",", "5"}], "}"}]], "Output",
 CellChangeTimes->{{3.7507120949097033`*^9, 3.7507121568727617`*^9}, 
   3.763742306847727*^9, 3.763742363341734*^9},
 CellLabel->
  "Out[141]=",ExpressionUUID->"c3e531f7-77ca-46af-823a-f5565a53f223"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Using
SeedRandom[2];
pts=RandSphere[10,2,1,1];

Here\[CloseCurlyQuote]s one element of vadjccws:
{9, {2, 16, 11}}
vi=9
faces[[2]] ={4,9,2}
faces[[16]]={5,9,4}
faces[[11]]={2,9,5}
The output we want for input vi is: {2,4,5}. 
Those are the indices of the vertices in star.

Initially, from faces[[2]] ={4,9,2}, we set star={2,4}. 
Probably just hardwire this in ad hoc.
Next we look at faces[[16]]={5,9,4}.
Don\[CloseCurlyQuote]t add 9==vi. 
Don\[CloseCurlyQuote]t add 4 because MemberQ[star,4]==True.
Because MemberQ[star,5]==False, add 5.
Next we look at faces[[11]]={2,9,5}.
Don\[CloseCurlyQuote]t add 9==vi. 
Don\[CloseCurlyQuote]t add 5 because MemberQ[star,5]==True.
Don\[CloseCurlyQuote]t add 2 because MemberQ[star,2]==True.
So we must have completed the circuit, as all three vertices are excluded.

A vertex of deg >3 would be more convincing.\
\>", "Subsubsection",
 CellChangeTimes->{{3.750712054640295*^9, 3.75071218760563*^9}, {
  3.750712248051271*^9, 3.750712524527574*^9}, {3.7507125788963423`*^9, 
  3.750712592359515*^9}, {3.750712626876959*^9, 
  3.750712650171777*^9}},ExpressionUUID->"df51f523-708e-47b9-95f6-\
7baee3eabb85"],

Cell[CellGroupData[{

Cell[BoxData["gpolyh"], "Input",
 CellChangeTimes->{{3.763742373248321*^9, 3.763742376138476*^9}},
 CellLabel->
  "In[142]:=",ExpressionUUID->"2d55b21d-9c62-4e65-bb94-1c76ff0ece3f"],

Cell[BoxData[
 Graphics3DBox[{
   {Opacity[0.5], 
    GraphicsComplex3DBox[{{1.3843824315066975`, 0.5686028401505108, 
     0.44447961821288695`}, {-1.9468747906786323`, -0.22132852381015644`, \
-0.05859455523361223}, {-0.5376107778940128, 0.9487199684634959, 
     0.16635529541217453`}, {-1.1946793995285403`, -0.44124724177060887`, \
-0.6696910890219172}, {0.22790172781235443`, -0.8535273266411705, 
     0.5084351515108025}, {1.6425845749446293`, 0.12273912798259565`, 
     0.5571481714953079}, {1.0667088420380166`, -0.025307051922532305`, 
     0.8455132256224434}, {1.8326008602834145`, 
     0.26623932191324523`, -0.2991824613664673}, {-1.3343032691133065`, \
-0.7449169786770292, 0.0027187105532253675`}, {-1.4764249572492054`, 
     0.611678005165793, 0.2844158124987368}}, 
     Polygon3DBox[{{10, 4, 2}, {4, 9, 2}, {8, 4, 3}, {5, 4, 8}, {7, 5, 6}, {6,
       5, 8}, {8, 1, 6}, {6, 1, 7}, {3, 4, 10}, {10, 2, 5}, {2, 9, 5}, {8, 3, 
      1}, {10, 5, 7}, {7, 3, 10}, {1, 3, 7}, {5, 9, 4}}]]}, 
   {RGBColor[0, 0, 1], 
    Text3DBox["1", {1.3843824315066975`, 0.5686028401505108, 
     0.44447961821288695`}], 
    Text3DBox[
     "2", {-1.9468747906786323`, -0.22132852381015644`, \
-0.05859455523361223}], 
    Text3DBox["3", {-0.5376107778940128, 0.9487199684634959, 
     0.16635529541217453`}], 
    Text3DBox[
     "4", {-1.1946793995285403`, -0.44124724177060887`, -0.6696910890219172}],
     Text3DBox["5", {0.22790172781235443`, -0.8535273266411705, 
     0.5084351515108025}], 
    Text3DBox["6", {1.6425845749446293`, 0.12273912798259565`, 
     0.5571481714953079}], 
    Text3DBox["7", {1.0667088420380166`, -0.025307051922532305`, 
     0.8455132256224434}], 
    Text3DBox["8", {1.8326008602834145`, 
     0.26623932191324523`, -0.2991824613664673}], 
    Text3DBox["9", {-1.3343032691133065`, -0.7449169786770292, 
     0.0027187105532253675`}], 
    Text3DBox["10", {-1.4764249572492054`, 0.611678005165793, 
     0.2844158124987368}]}, 
   {RGBColor[1, 0, 0], 
    Text3DBox[
     "1", {-1.5393263824854593`, -0.016965920138324115`, \
-0.14795661058559753`}], 
    Text3DBox[
     "2", {-1.4919524864401599`, -0.4691642480859315, -0.2418556445674347}], 
    Text3DBox["3", {0.033436894286953844`, 
     0.2579040162020441, -0.26750608499206996`}], 
    Text3DBox["4", {
     0.28860772952240954`, -0.342845082166178, -0.15347946629252732`}], 
    Text3DBox["5", {0.9790650482650001, -0.2520317501937024, 
     0.6370321828761846}], 
    Text3DBox["6", {1.2343623876801326`, -0.1548496255817765, 
     0.25546695387988105`}], 
    Text3DBox["7", {1.619855955578247, 0.31919376334878385`, 
     0.23414844278057584`}], 
    Text3DBox["8", {1.3645586161631142`, 0.22201163873685803`, 
     0.6157136717768794}], 
    Text3DBox["9", {-1.0695717115572527`, 
     0.3730502439528933, -0.07297332703700195}], 
    Text3DBox["10", {-1.0651326733718278`, -0.154392615095178, 
     0.24475213625864237`}], 
    Text3DBox["11", {-1.0177587773265282`, -0.6065909430427854, 
     0.1508531022768052}], 
    Text3DBox["12", {0.8931241712986997, 0.5945207101757506, 
     0.10388415075286472`}], 
    Text3DBox["13", {-0.06060479579961142, -0.08905212446596994, 
     0.5461213965439942}], 
    Text3DBox["14", {-0.3157756310350671, 0.5116969739022521, 
     0.43209477784445155`}], 
    Text3DBox["15", {0.637826831883567, 0.4973385855638247, 
     0.48544937974916824`}], 
    Text3DBox[
     "16", {-0.7670269802764974, -0.6798971823629361, -0.05284574231929643}]}, 
   {RGBColor[0, 1, 0], 
    Point3DBox[{{1.3843824315066975`, 0.5686028401505108, 
     0.44447961821288695`}, {-1.9468747906786323`, -0.22132852381015644`, \
-0.05859455523361223}, {-0.5376107778940128, 0.9487199684634959, 
     0.16635529541217453`}, {-1.1946793995285403`, -0.44124724177060887`, \
-0.6696910890219172}, {0.22790172781235443`, -0.8535273266411705, 
     0.5084351515108025}, {1.6425845749446293`, 0.12273912798259565`, 
     0.5571481714953079}, {1.0667088420380166`, -0.025307051922532305`, 
     0.8455132256224434}, {1.8326008602834145`, 
     0.26623932191324523`, -0.2991824613664673}, {-1.3343032691133065`, \
-0.7449169786770292, 0.0027187105532253675`}, {-1.4764249572492054`, 
     0.611678005165793, 0.2844158124987368}}]}},
  Boxed->False,
  ImageSize->Small]], "Output",
 CellChangeTimes->{3.763742377135045*^9},
 CellLabel->
  "Out[142]=",ExpressionUUID->"ff15e44f-54a3-4119-9fc4-fe21ab59473c"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1200, 851},
WindowMargins->{{116, Automatic}, {Automatic, 0}},
Magnification:>2. Inherited,
FrontEndVersion->"11.3 for Mac OS X x86 (32-bit, 64-bit Kernel) (March 5, \
2018)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[579, 22, 449, 6, 226, "Title",ExpressionUUID->"ed844cd3-a798-44ce-ada8-e838a44795f4"],
Cell[1031, 30, 437, 9, 202, "Subtitle",ExpressionUUID->"804c97eb-a71d-423e-9bbf-1db4574b0322"],
Cell[1471, 41, 958, 17, 236, "Text",ExpressionUUID->"2811374c-8e31-4c40-aee7-c324200a9a2c"],
Cell[2432, 60, 159, 3, 59, "Input",ExpressionUUID->"6dfec787-e548-40b6-bd2c-a0be118bbc12"],
Cell[2594, 65, 1307, 28, 236, "Text",ExpressionUUID->"0243a947-b443-4538-83cc-e9bc4ad82c43"],
Cell[3904, 95, 1074, 20, 146, "Text",ExpressionUUID->"af28bdcc-e10c-4877-b403-7ce6d3921187"],
Cell[4981, 117, 1082, 18, 146, "Text",ExpressionUUID->"a7e265fa-6373-4158-9d22-f827bf9c0dad"],
Cell[6066, 137, 3302, 82, 697, "Input",ExpressionUUID->"ee332a8c-45c2-41bd-92ac-73409a5341bd"],
Cell[9371, 221, 1132, 31, 191, "Text",ExpressionUUID->"a35422a9-abf7-4e53-8796-b47672062608"],
Cell[10506, 254, 7989, 190, 1599, "Input",ExpressionUUID->"e0404b75-6e68-47f5-ae13-44e1dd11356e"],
Cell[18498, 446, 597, 16, 191, "Text",ExpressionUUID->"de462047-8eb9-4782-bf55-84a0eef67bd9"],
Cell[19098, 464, 8146, 180, 1659, "Input",ExpressionUUID->"bb59d684-bfd6-4057-bbcf-337822f3a6c2"],
Cell[27247, 646, 205, 3, 101, "Text",ExpressionUUID->"2a609cfa-1f9c-486c-8f11-ba9ebc7cee8d"],
Cell[27455, 651, 2434, 39, 246, "Input",ExpressionUUID->"9e2b9a3f-fa87-4f53-9139-94f756c32bda"],
Cell[CellGroupData[{
Cell[29914, 694, 860, 17, 246, "Input",ExpressionUUID->"30ae440c-6701-452b-a162-972fd7b0d5d0"],
Cell[30777, 713, 1260, 24, 172, "Output",ExpressionUUID->"0972617a-0f3e-4ce2-a1ea-85700aca0445"]
}, Open  ]],
Cell[CellGroupData[{
Cell[32074, 742, 340, 7, 81, "Input",ExpressionUUID->"f18b059a-eeb9-46c2-baed-87c6ff29ebc8"],
Cell[CellGroupData[{
Cell[32439, 753, 600, 13, 47, "Print",ExpressionUUID->"14074905-08b5-4dd0-a52a-7b8dc29393c1"],
Cell[33042, 768, 595, 13, 47, "Print",ExpressionUUID->"135c1dae-181d-4ef9-8e71-0cd37af80a73"],
Cell[33640, 783, 603, 13, 47, "Print",ExpressionUUID->"c3381e11-1eda-4ed3-8a34-f56248defe68"],
Cell[34246, 798, 616, 14, 47, "Print",ExpressionUUID->"03113baa-9778-493e-8c99-642b9c7ed3ec"]
}, Open  ]],
Cell[34877, 815, 4473, 91, 325, "Output",ExpressionUUID->"a39df94f-35ea-408f-8ae0-530fce8d2208"]
}, Open  ]],
Cell[CellGroupData[{
Cell[39387, 911, 218, 5, 107, "Subsection",ExpressionUUID->"c550ef75-3ac0-469a-abaf-4b2359a362e8"],
Cell[39608, 918, 600, 14, 164, "Input",ExpressionUUID->"d9a72e07-350c-42cb-8a21-12527ce65f31"],
Cell[CellGroupData[{
Cell[40233, 936, 232, 5, 81, "Input",ExpressionUUID->"bd073e67-df42-4d7a-b088-8638c8a06800"],
Cell[40468, 943, 205, 4, 89, "Output",ExpressionUUID->"8c6fe526-e486-4a71-b0c0-c299136ac2f6"]
}, Open  ]],
Cell[CellGroupData[{
Cell[40710, 952, 212, 4, 81, "Input",ExpressionUUID->"605d8bba-ceee-4cb0-91bd-0afe39c01983"],
Cell[40925, 958, 213, 4, 89, "Output",ExpressionUUID->"70630c18-bed7-438b-8a43-7283f156a33e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[41175, 967, 185, 3, 81, "Input",ExpressionUUID->"143f5456-681a-4a18-aba1-db4bbb4bd636"],
Cell[41363, 972, 277, 5, 89, "Output",ExpressionUUID->"acf587db-013a-42d2-be56-2d73eee2af34"]
}, Open  ]],
Cell[CellGroupData[{
Cell[41677, 982, 231, 5, 81, "Input",ExpressionUUID->"dc86b4aa-cbf4-4276-b063-5eb15d3bfdb0"],
Cell[41911, 989, 284, 6, 89, "Output",ExpressionUUID->"c3e531f7-77ca-46af-823a-f5565a53f223"]
}, Open  ]],
Cell[CellGroupData[{
Cell[42232, 1000, 1156, 32, 1415, "Subsubsection",ExpressionUUID->"df51f523-708e-47b9-95f6-7baee3eabb85"],
Cell[CellGroupData[{
Cell[43413, 1036, 181, 3, 81, "Input",ExpressionUUID->"2d55b21d-9c62-4e65-bb94-1c76ff0ece3f"],
Cell[43597, 1041, 4411, 89, 325, "Output",ExpressionUUID->"ff15e44f-54a3-4119-9fc4-fe21ab59473c"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

