(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     83569,       1810]
NotebookOptionsPosition[     80044,       1747]
NotebookOutlinePosition[     80387,       1762]
CellTagsIndexPosition[     80344,       1759]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[TextData[{
 StyleBox["Hamann\[CloseCurlyQuote]s P-lines Algorithm",
  Background->RGBColor[0.94, 0.91, 0.88]],
 "\n",
 StyleBox["Assumes the following have been run in the order:\n", "Subtitle",
  Background->RGBColor[0.94, 0.91, 0.88]],
 StyleBox["Triangle.Angles.nb\nPolyhedronDS.nb\nConvexCapMakeDS.nb\n\
ConvexPolyhedronMake.nb\n\nTo change properties of the polyhedron on which \
this runs, go into ConvexPolyhedronMake", "ItemNumbered",
  Background->RGBColor[0.94, 0.91, 0.88]]
}], "Title",
 CellChangeTimes->{{3.7480144117033243`*^9, 3.7480145893571377`*^9}, {
  3.7490592167491293`*^9, 3.749059218109052*^9}, {3.749059422827094*^9, 
  3.7490594714856653`*^9}},
 Background->RGBColor[
  0.94, 0.91, 0.88],ExpressionUUID->"6ec8c87a-ce39-48c1-a77d-1e8562fb4ed0"],

Cell[CellGroupData[{

Cell["Step 1: Calculate normal plane + vector for every vertex", "Section",
 CellChangeTimes->{{3.7480145940151854`*^9, 3.7480145954520283`*^9}, {
  3.748014816549488*^9, 3.748014834568035*^9}, {3.748015999188587*^9, 
  3.748016011282733*^9}, {3.748016332225358*^9, 3.748016334183225*^9}, {
  3.7490593401291685`*^9, 3.749059340940406*^9}, {3.7490593812518754`*^9, 
  3.749059395862385*^9}},ExpressionUUID->"55c19859-bd91-4eaf-a717-\
4f6b2d552445"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.749244269059801*^9, 3.749244269863655*^9}},
 CellLabel->
  "In[310]:=",ExpressionUUID->"afd995fb-d4dc-4cf8-ab61-607c75bb165a"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"GetNormal", "[", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "vi", ",", " ", "finds", ",", " ", "areaSum", ",", " ", "vectorSum", 
        ",", " ", "fi", ",", " ", "face", ",", " ", "pts", ",", " ", 
        "faceArea", ",", " ", "faceNorm", ",", "normXArea", ",", "v", ",", 
        " ", "arrow", ",", " ", "i", ",", " ", "j", ",", " ", "g"}], "}"}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"nvecs", " ", "=", " ", 
        RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", "=", "1"}], ",", 
         RowBox[{"i", "\[LessEqual]", 
          RowBox[{"Length", "@", "vadjccws"}]}], ",", 
         RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"vi", "=", 
           RowBox[{
            RowBox[{
            "vadjccws", "\[LeftDoubleBracket]", "i", 
             "\[RightDoubleBracket]"}], "\[LeftDoubleBracket]", "1", 
            "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"finds", "=", 
           RowBox[{
            RowBox[{
            "vadjccws", "\[LeftDoubleBracket]", "i", 
             "\[RightDoubleBracket]"}], "\[LeftDoubleBracket]", "2", 
            "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"areaSum", " ", "=", " ", "0"}], ";", " ", 
          RowBox[{"(*", 
           RowBox[{"initialize", " ", "areaSum", " ", "for", " ", "later"}], 
           "*)"}], "\[IndentingNewLine]", 
          RowBox[{"vectorSum", " ", "=", " ", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], ";", " ", 
          RowBox[{"(*", 
           RowBox[{"initialize", " ", "vectorSum", " ", "for", " ", "later"}],
            "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"j", "=", "1"}], ",", 
            RowBox[{"j", "\[LessEqual]", 
             RowBox[{"Length", "[", "finds", "]"}]}], ",", 
            RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"fi", "=", 
              RowBox[{
              "finds", "\[LeftDoubleBracket]", "j", 
               "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
             "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{"compute", " ", "face", " ", "normal"}], "*)"}], 
             "\[IndentingNewLine]", 
             RowBox[{"faceNorm", " ", "=", " ", 
              RowBox[{"FaceNormal", "[", "fi", "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{"debug1", ",", 
                 RowBox[{"Print", "[", 
                  RowBox[{"\"\<i,j,faceNorm\>\"", ",", 
                   RowBox[{"{", 
                    RowBox[{"i", ",", "j", ",", "faceNorm"}], "}"}]}], 
                  "]"}]}], "]"}], ";"}], "*)"}], "\[IndentingNewLine]", 
             "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{
              "compute", " ", "area", " ", "of", " ", "face", " ", "fi"}], 
              "*)"}], "\[IndentingNewLine]", 
             RowBox[{"face", " ", "=", " ", 
              RowBox[{
              "faces", "\[LeftDoubleBracket]", "fi", 
               "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"pts", " ", "=", " ", 
              RowBox[{
              "verts3d", "\[LeftDoubleBracket]", "face", 
               "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"faceArea", " ", "=", " ", 
              RowBox[{"TriArea3d", "[", "pts", "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{"debug1", ",", 
                 RowBox[{"Print", "[", 
                  RowBox[{"\"\<facearea\>\"", ",", " ", "faceArea"}], "]"}]}],
                 "]"}], ";"}], "*)"}], "\[IndentingNewLine]", 
             "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{"area", " ", "x", " ", "normal"}], "*)"}], 
             "\[IndentingNewLine]", 
             RowBox[{"normXArea", " ", "=", " ", 
              RowBox[{"faceNorm", " ", "*", " ", "faceArea"}]}], ";", 
             "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{
              "add", " ", "up", " ", "areas", " ", "into", " ", "running", 
               " ", "sum"}], "*)"}], "\[IndentingNewLine]", 
             RowBox[{"areaSum", "+=", "faceArea"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{
               RowBox[{"Print", "[", 
                RowBox[{"\"\<areaSum\>\"", ",", " ", "areaSum"}], "]"}], 
               ";"}], "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{
              "add", " ", "to", " ", "running", " ", "total", " ", "of", " ", 
               "the", " ", "vectors"}], "*)"}], "\[IndentingNewLine]", 
             RowBox[{"vectorSum", "+=", "normXArea"}], ";"}]}], 
           "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"Print", "[", 
              RowBox[{"\"\<vectorSum\>\"", ",", " ", "vectorSum"}], "]"}], 
             ";"}], "*)"}], "\[IndentingNewLine]", "]"}], ";", 
          RowBox[{"(*", "Forj", "*)"}], "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
           "divide", " ", "weighted", " ", "normal", " ", "with", " ", "the", 
            " ", "total", " ", "area", " ", "weight"}], "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"v", " ", "=", " ", 
           RowBox[{"vectorSum", " ", "/", " ", "areaSum"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"v", " ", "=", " ", 
           RowBox[{"Normalize", "[", "v", "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"nvecs", ",", " ", "v"}], "]"}], ";"}]}], " ", 
        RowBox[{"(*", 
         RowBox[{"add", " ", "to", " ", "vector", " ", "list"}], "*)"}], 
        "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}], ";", 
       RowBox[{"(*", "Fori", "*)"}], "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"visualization", " ", "code"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"g", "=", 
        RowBox[{"Graphics3D", "[", 
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Opacity", "[", "0.5", "]"}], ",", 
             RowBox[{"GraphicsComplex", "[", 
              RowBox[{"verts3d", ",", 
               RowBox[{"Polygon", "[", "faces", "]"}]}], "]"}]}], "}"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"Blue", ",", 
             RowBox[{"VertsLabels", "[", 
              RowBox[{"Range", "[", 
               RowBox[{"Length", "[", "faces", "]"}], "]"}], "]"}]}], "}"}], 
           ",", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"MapThread", "[", " ", 
             RowBox[{
              RowBox[{
               RowBox[{"Arrow", "[", 
                RowBox[{"{", 
                 RowBox[{"#1", ",", 
                  RowBox[{"#1", "+", "#2"}]}], "}"}], "]"}], "&"}], ",", 
              RowBox[{"{", 
               RowBox[{"verts3d", ",", "nvecs"}], "}"}]}], "]"}], "}"}]}], 
          "\[IndentingNewLine]", "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", "g", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "nvecs", "]"}], ";"}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"GetNormal", "[", "]"}], ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.748014852651929*^9, 3.748014895921958*^9}, {
   3.748015106485054*^9, 3.748015167761895*^9}, {3.74801520169816*^9, 
   3.748015229899931*^9}, 3.748015904985845*^9, {3.748016178957163*^9, 
   3.7480162922341003`*^9}, {3.748016340129832*^9, 3.7480163437101293`*^9}, {
   3.7480164562701187`*^9, 3.7480165103214355`*^9}, {3.748016618116352*^9, 
   3.7480166195319414`*^9}, {3.748456546862463*^9, 3.7484565932558174`*^9}, {
   3.748456840571225*^9, 3.7484568702416754`*^9}, 3.7490592899370804`*^9, {
   3.749059374234923*^9, 3.74905937453971*^9}, {3.749061650094701*^9, 
   3.7490616710015397`*^9}, {3.749061717550568*^9, 3.7490618344873085`*^9}, {
   3.749061905364066*^9, 3.749061954422976*^9}, {3.7490619844880004`*^9, 
   3.7490620535011063`*^9}, {3.7490621303747845`*^9, 3.749062153687256*^9}, {
   3.749062249970476*^9, 3.749062277535585*^9}, {3.7490626496250553`*^9, 
   3.7490626564554977`*^9}, {3.7490626986320086`*^9, 3.749062768749813*^9}, {
   3.749062830250616*^9, 3.74906298037864*^9}, {3.7490631341624527`*^9, 
   3.7490631352994566`*^9}, {3.7490632084588594`*^9, 
   3.7490633331153436`*^9}, {3.7492427752517977`*^9, 3.749242898344565*^9}, {
   3.7492429452800817`*^9, 3.7492430010110006`*^9}, {3.749243059488614*^9, 
   3.7492430970529313`*^9}, 3.7492434499555197`*^9, {3.749243683951095*^9, 
   3.749243724926515*^9}, {3.749243769077654*^9, 3.7492437818395567`*^9}, {
   3.749243922717802*^9, 3.749243930104019*^9}, {3.74924396514763*^9, 
   3.7492439654528537`*^9}, {3.749244201966264*^9, 3.749244303691231*^9}, {
   3.7492443342594366`*^9, 3.749244339293972*^9}, {3.74924437595393*^9, 
   3.749244379265107*^9}, {3.7492444277095504`*^9, 3.7492444289671574`*^9}, {
   3.749288823139062*^9, 3.749288824039733*^9}, {3.7492891985379066`*^9, 
   3.749289270500472*^9}, {3.7492893056938734`*^9, 3.7492893228400993`*^9}, {
   3.749289409894246*^9, 3.749289429134469*^9}, {3.7492894999827385`*^9, 
   3.7492895841307926`*^9}, {3.7492896176535077`*^9, 
   3.7492896217284546`*^9}, {3.7492897367939982`*^9, 3.749289812833319*^9}, {
   3.7492902706897793`*^9, 3.74929027478411*^9}, {3.749290315596775*^9, 
   3.749290345093335*^9}, {3.749290550555503*^9, 3.749290590530613*^9}, {
   3.74929092098215*^9, 3.749290922357757*^9}, {3.750067029711027*^9, 
   3.7500670418110366`*^9}, 3.750067079016959*^9, {3.7500671277690287`*^9, 
   3.750067270912199*^9}, {3.750067323472213*^9, 3.750067336099304*^9}, {
   3.7500675982616835`*^9, 3.7500676258688583`*^9}, {3.750067658261051*^9, 
   3.750067666850272*^9}, {3.750067785572961*^9, 3.7500677991552353`*^9}, {
   3.750067894002095*^9, 3.75006792306785*^9}, {3.750068229660327*^9, 
   3.7500682563535843`*^9}, {3.7500683450060143`*^9, 3.750068345539235*^9}, {
   3.750068642919505*^9, 3.750068657725363*^9}, {3.7500686947801533`*^9, 
   3.750068697516736*^9}, {3.7500687548178396`*^9, 3.7500687551711264`*^9}, 
   3.750068785712747*^9, {3.750068996611571*^9, 3.7500690163401966`*^9}, {
   3.7500692263654118`*^9, 3.7500692836219*^9}, {3.7500697685312057`*^9, 
   3.750069780483025*^9}, {3.750069874202031*^9, 3.750069942434761*^9}, {
   3.7500699968980374`*^9, 3.7500700124225607`*^9}, {3.750070202107531*^9, 
   3.75007030399757*^9}, {3.7500703386751814`*^9, 3.750070572972432*^9}, {
   3.7500706231153316`*^9, 3.750070650220052*^9}, {3.7500706925499077`*^9, 
   3.75007069436229*^9}, {3.750070793470026*^9, 3.7500708285621576`*^9}, {
   3.750070893658497*^9, 3.750070958223972*^9}, {3.750071001302146*^9, 
   3.7500711002655573`*^9}, {3.750071256206231*^9, 3.750071274769868*^9}, {
   3.7500713115132236`*^9, 3.7500713178881435`*^9}, {3.7501740577840304`*^9, 
   3.750174133742557*^9}, {3.750174212785903*^9, 3.750174239736047*^9}, {
   3.750174273480262*^9, 3.750174329662282*^9}, {3.750174405566701*^9, 
   3.7501744606535883`*^9}, {3.750174507902648*^9, 3.750174529247876*^9}, {
   3.750174561643674*^9, 3.7501745759615607`*^9}, {3.75017461192972*^9, 
   3.750174613253889*^9}, {3.750174778586115*^9, 3.75017480670819*^9}, {
   3.7501748587227335`*^9, 3.7501748602091885`*^9}, {3.750174903241249*^9, 
   3.750175022051008*^9}, 3.7501750729559546`*^9, 3.750175112692299*^9, {
   3.7501751734991355`*^9, 3.750175212109364*^9}, {3.7501756711127663`*^9, 
   3.750175767424368*^9}, {3.750175855014861*^9, 3.750175861786705*^9}, {
   3.7501758995837393`*^9, 3.750175931867738*^9}, {3.750176021952503*^9, 
   3.750176086325694*^9}, {3.7501762156213646`*^9, 3.75017625498588*^9}, {
   3.7501763221866055`*^9, 3.7501763226164017`*^9}, 3.7501763951456084`*^9, {
   3.750182030551799*^9, 3.7501821263025503`*^9}, {3.7501821704489107`*^9, 
   3.7501822177149076`*^9}, {3.7501822494021864`*^9, 
   3.7501822766452336`*^9}, {3.750182307648676*^9, 3.7501823254924316`*^9}, {
   3.750182459904855*^9, 3.7501824759119444`*^9}, {3.750675737855936*^9, 
   3.750675750002999*^9}, {3.753367533803012*^9, 3.753367534846455*^9}, {
   3.7533675940426455`*^9, 3.7533676249604397`*^9}, 3.7534683322708187`*^9, {
   3.7534684562750654`*^9, 3.75346855221461*^9}, {3.753468611396764*^9, 
   3.753468640050864*^9}, 3.753468801915676*^9, {3.7534688920449185`*^9, 
   3.7534688982837048`*^9}, {3.7534690429644165`*^9, 3.753469045519079*^9}, {
   3.753469351940141*^9, 3.7534693657441907`*^9}, {3.7534739310160117`*^9, 
   3.7534739765153*^9}, {3.7582103808636856`*^9, 3.7582103942509193`*^9}},
 CellLabel->
  "In[311]:=",ExpressionUUID->"7409b5de-f013-481e-adc3-3eadfc67703e"],

Cell[BoxData[
 Graphics3DBox[{
   {Opacity[0.5], 
    GraphicsComplex3DBox[{{0., 0., 
     0.6123724356957945}, {-0.2886751345948129, -0.5, -0.20412414523193154`}, \
{-0.2886751345948129, 0.5, -0.20412414523193154`}, {0.5773502691896258, 
     0., -0.20412414523193154`}}, 
     Polygon3DBox[{{2, 4, 1}, {4, 3, 1}, {2, 3, 4}, {1, 3, 2}}]]}, 
   {RGBColor[0, 0, 1], Text3DBox["1", {0., 0., 0.6123724356957945}], 
    Text3DBox["2", {-0.2886751345948129, -0.5, -0.20412414523193154`}], 
    Text3DBox["3", {-0.2886751345948129, 0.5, -0.20412414523193154`}], 
    Text3DBox["4", {0.5773502691896258, 0., -0.20412414523193154`}]}, {
    Arrow3DBox[{{0., 0., 0.6123724356957945}, {0., 0., 1.6123724356957945`}}],
     Arrow3DBox[{{-0.2886751345948129, -0.5, -0.20412414523193154`}, \
{-0.7600796553858444, -1.316496580927726, -0.5374574785652648}}], 
    Arrow3DBox[{{-0.2886751345948129, 
     0.5, -0.20412414523193154`}, {-0.7600796553858444, 
     1.316496580927726, -0.5374574785652649}}], 
    Arrow3DBox[{{0.5773502691896258, 0., -0.20412414523193154`}, {
     1.5201593107716893`, 0., -0.5374574785652649}}]}}]], "Print",
 CellChangeTimes->{
  3.753468336138319*^9, 3.753468487632755*^9, {3.753468530240224*^9, 
   3.753468555267359*^9}, {3.7534686231394978`*^9, 3.7534686407208323`*^9}, 
   3.753468966005947*^9, 3.7534690469275064`*^9, {3.753469585002496*^9, 
   3.7534696001796155`*^9}, 3.753469637910073*^9, {3.753473932061221*^9, 
   3.7534739367167625`*^9}, 3.7534739790046425`*^9, 3.7553748174308777`*^9, 
   3.7565066048956184`*^9, 3.7569192200118876`*^9, 3.7570004067707815`*^9, 
   3.757095801592718*^9, 3.7576008658290253`*^9, 3.7577007190600853`*^9, 
   3.7577016283283625`*^9, 3.7577016768821163`*^9, 3.757701792645666*^9, 
   3.7577837834289556`*^9, 3.757784111029688*^9, 3.757784601511895*^9, 
   3.757784827813195*^9, 3.7577857831033573`*^9, {3.757786127973511*^9, 
   3.7577861486944094`*^9}, 3.7582096361810617`*^9, 3.758209854117854*^9, 
   3.758553810909432*^9, 3.7585646579982843`*^9, 3.7590822296882353`*^9, 
   3.7591683352352037`*^9, 3.759407200222787*^9, 3.759849045672123*^9, 
   3.7602005153636208`*^9, 3.760201326194158*^9, 3.7602017573494387`*^9},
 CellLabel->
  "During evaluation of \
In[311]:=",ExpressionUUID->"dcfdc30e-e696-4563-9082-a31e5f3f6cda"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Step 2: Calculate all adjacent vertices for each v, and find distance of \
vertices to plane\
\>", "Section",
 CellChangeTimes->{{3.748016597062249*^9, 3.7480166097917643`*^9}, {
  3.7490593996464896`*^9, 3.749059399912037*^9}, {3.7501823368453846`*^9, 
  3.750182359668713*^9}, {3.758210423064843*^9, 
  3.758210428851403*^9}},ExpressionUUID->"6f3d8367-ffa0-4608-b86c-\
1badf0f55516"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "takes", " ", "in", " ", "single", " ", "vertex", " ", "and", " ", 
    "returns", " ", "list", " ", "of", " ", "adj", " ", "verts"}], " ", 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"GetAdjSingle", "[", "v_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"star", ",", " ", "finds", ",", " ", "i", ",", " ", "vi"}], 
        "}"}], ",", " ", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"initialize", " ", "variables"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"star", " ", "=", " ", 
         RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"vi", " ", "=", " ", 
         RowBox[{
          RowBox[{
          "vadjccws", "\[LeftDoubleBracket]", "v", "\[RightDoubleBracket]"}], 
          "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"finds", " ", "=", " ", 
         RowBox[{
          RowBox[{
          "vadjccws", "\[LeftDoubleBracket]", "v", "\[RightDoubleBracket]"}], 
          "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], ";", " ", 
        RowBox[{"(*", 
         RowBox[{"faces", " ", "around", " ", "v"}], "*)"}], 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"loop", " ", "through", " ", "face", " ", "indices"}], ",", 
          " ", 
          RowBox[{"find", " ", "associated", " ", "vertices"}]}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "tests", " ", "if", " ", "each", " ", "found", " ", "vertices", " ", 
          "is", " ", "adjacent", " ", "to", " ", "specified", " ", "starting",
           " ", "vertex"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"i", "=", "1"}], ",", " ", 
          RowBox[{"i", "\[LessEqual]", 
           RowBox[{"Length", "@", "finds"}]}], ",", " ", 
          RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"fi", " ", "=", " ", 
            RowBox[{
            "finds", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}],
            ";", "\[IndentingNewLine]", 
           RowBox[{"face", "=", " ", 
            RowBox[{
            "faces", "\[LeftDoubleBracket]", "fi", 
             "\[RightDoubleBracket]"}]}], ";", " ", 
           RowBox[{"(*", 
            RowBox[{"list", " ", "of", " ", "verts"}], "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{"For", " ", "[", 
            RowBox[{
             RowBox[{"j", " ", "=", " ", "1"}], ",", " ", 
             RowBox[{"j", "\[LessEqual]", " ", 
              RowBox[{"Length", "@", "face"}]}], ",", " ", 
             RowBox[{"j", "++"}], ",", " ", "\[IndentingNewLine]", 
             RowBox[{"If", " ", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                  "face", "\[LeftDoubleBracket]", "j", 
                   "\[RightDoubleBracket]"}], " ", "\[NotEqual]", " ", "v"}], 
                 ")"}], " ", "&&", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"MemberQ", "[", 
                   RowBox[{"star", ",", " ", 
                    RowBox[{
                    "face", "\[LeftDoubleBracket]", "j", 
                    "\[RightDoubleBracket]"}]}], "]"}], " ", "\[Equal]", " ", 
                  "False"}], ")"}]}], ",", " ", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"AppendTo", "[", 
                 RowBox[{"star", ",", " ", 
                  RowBox[{
                  "face", "\[LeftDoubleBracket]", "j", 
                   "\[RightDoubleBracket]"}]}], "]"}], ";"}]}], 
              "\[IndentingNewLine]", "]"}]}], " ", 
            RowBox[{"(*", 
             RowBox[{"end", " ", "if"}], "*)"}], "\[IndentingNewLine]", "]"}],
            ";"}]}], 
         RowBox[{"(*", " ", 
          RowBox[{"for", " ", "j"}], "*)"}], "\[IndentingNewLine]", "]"}], 
        ";", " ", 
        RowBox[{"(*", 
         RowBox[{"for", " ", "i"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "star", "]"}], ";"}]}], "\[IndentingNewLine]", 
      "]"}]}], ";"}], "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.7501823765436554`*^9, 3.7501824165805817`*^9}, {
   3.7501933953437634`*^9, 3.750193426141494*^9}, {3.750674862821703*^9, 
   3.7506751595282664`*^9}, {3.750675203572327*^9, 3.750675214966196*^9}, {
   3.7506752515477085`*^9, 3.7506753331784306`*^9}, {3.750675372847163*^9, 
   3.7506753794917827`*^9}, 3.7506755562646856`*^9, {3.7506756390128946`*^9, 
   3.7506757107056127`*^9}, {3.7506757561919184`*^9, 3.750675856960178*^9}, {
   3.7506758935439224`*^9, 3.7506759486030607`*^9}, {3.750676197731307*^9, 
   3.7506761980721617`*^9}, {3.7506763061400223`*^9, 
   3.7506763102404675`*^9}, {3.7506763926053953`*^9, 
   3.7506764138106685`*^9}, {3.750676479565322*^9, 3.7506764955224185`*^9}, {
   3.7506767815640507`*^9, 3.7506769154126673`*^9}, {3.75067700502212*^9, 
   3.7506770193939333`*^9}, {3.7506770560068927`*^9, 3.750677070684083*^9}, {
   3.7506771192941203`*^9, 3.7506771596492324`*^9}, {3.750677201391144*^9, 
   3.7506772903511724`*^9}, {3.7506773246767263`*^9, 3.750677330432864*^9}, {
   3.7506774161999598`*^9, 3.7506774429861426`*^9}, {3.7506774813083754`*^9, 
   3.7506775165126295`*^9}, {3.750677579841468*^9, 3.7506775925994587`*^9}, {
   3.750677623897792*^9, 3.7506776992127237`*^9}, {3.750700939296609*^9, 
   3.7507009548978863`*^9}, {3.750865958731541*^9, 3.7508660135148277`*^9}, {
   3.750866105418168*^9, 3.750866142168831*^9}, {3.7508662118907104`*^9, 
   3.7508666957314143`*^9}, {3.750866754550351*^9, 3.7508667576075706`*^9}, {
   3.750866881485057*^9, 3.750866983911991*^9}, {3.750867020872195*^9, 
   3.7508670782852035`*^9}, {3.750867187100916*^9, 3.7508672520729647`*^9}, {
   3.75086728319193*^9, 3.75086729008411*^9}, {3.7508674477709975`*^9, 
   3.750867484876081*^9}, {3.750867571787262*^9, 3.750867571987775*^9}, {
   3.750867610887005*^9, 3.7508676876703577`*^9}, 3.7508679145672607`*^9, {
   3.7508689845572557`*^9, 3.7508689954913855`*^9}, 3.7508693710822515`*^9, {
   3.7508694137951727`*^9, 3.7508694138980646`*^9}, {3.7534691608714914`*^9, 
   3.753469161183416*^9}, {3.7582101269516687`*^9, 3.758210203906541*^9}},
 CellLabel->
  "In[313]:=",ExpressionUUID->"8234589e-3f4f-4620-9bae-162c02254800"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "This", " ", "function", " ", "takes", " ", "in", " ", "a", " ", "list", 
    " ", "of", " ", "verts", " ", "and", " ", "finds", " ", "all", " ", 
    "adjacent", " ", "vertices"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"GetAdj", "[", "vList_", "]"}], ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"final", ",", " ", "i", ",", " ", "star"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"final", " ", "=", " ", 
        RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{
         "loop", " ", "through", " ", "given", " ", "list", " ", "of", " ", 
          "vertices"}], ",", " ", 
         RowBox[{
         "call", " ", "helper", " ", "function", " ", "to", " ", "get", " ", 
          "full", " ", "list"}]}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"For", " ", "[", 
        RowBox[{
         RowBox[{"i", "=", "1"}], ",", " ", 
         RowBox[{"i", "\[LessEqual]", " ", 
          RowBox[{"Length", "@", "vList"}]}], ",", " ", 
         RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"star", " ", "=", " ", 
           RowBox[{"GetAdjSingle", "[", 
            RowBox[{
            "vList", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
            "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"final", ",", " ", 
            RowBox[{
            "vList", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}],
            "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"final", ",", " ", "star"}], "]"}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", " ", 
       RowBox[{"(*", 
        RowBox[{"for", " ", "i"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "final", "]"}], ";"}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.7508689987403526`*^9, 3.750869169224201*^9}, {
  3.750869238516944*^9, 3.7508692739907885`*^9}, {3.7508693252424717`*^9, 
  3.7508693745545197`*^9}, {3.750869431366274*^9, 3.750869476726118*^9}, {
  3.750869547606375*^9, 3.750869547814432*^9}, {3.750869578935916*^9, 
  3.7508695792690525`*^9}, {3.7577866431766567`*^9, 3.757786645204789*^9}, {
  3.758210080928097*^9, 3.758210115831856*^9}},
 CellLabel->
  "In[314]:=",ExpressionUUID->"63788c11-9339-4554-a838-12d2506987ab"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{
  3.755374907678409*^9, {3.757786647685093*^9, 3.7577866486953554`*^9}, {
   3.758210025344062*^9, 3.758210026341902*^9}},
 CellLabel->
  "In[315]:=",ExpressionUUID->"08b05fe8-16e4-43b7-b2a0-1ea6cc5fec3c"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "this", " ", "function", " ", "transforms", " ", "the", " ", "coordinate",
      " ", "system", " ", "of", " ", "the", " ", "polyhedron"}], ",", " ", 
    RowBox[{
     RowBox[{
     "making", " ", "the", " ", "distance", " ", "of", " ", "each", " ", "pt",
       " ", "to", " ", "the", " ", "plane", " ", "the", " ", "z"}], "-", 
     RowBox[{"axis", " ", "coordinate"}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"TO", " ", 
    RowBox[{"DO", ":", " ", 
     RowBox[{
     "translist", " ", "no", " ", "longer", " ", "list", " ", "of", " ", 
      "lists", " ", 
      RowBox[{"w", "/", " ", "new"}], " ", "loop", " ", 
      RowBox[{"structure", ".", " ", "Potential"}], " ", 
      RowBox[{"problem", "?"}]}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"TransCoords", "[", "]"}], " ", ":=", " ", 
     RowBox[{"Module", " ", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "vi", ",", " ", "nvec", ",", " ", "p", ",", " ", "ptrans", ",", " ", 
         "v", ",", " ", "transList"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "initialize", " ", "output", " ", "and", " ", "normal", " ", 
         "vectors"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"transList", " ", "=", " ", 
         RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"norms", " ", "=", " ", 
         RowBox[{"GetNormal", "[", "]"}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "loop", " ", "through", " ", "all", " ", "vertices", " ", "and", " ",
           "calculate", " ", "adjacent", " ", 
          RowBox[{"v", "'"}], "s"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"glist", " ", "=", " ", 
         RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"For", " ", "[", 
         RowBox[{
          RowBox[{"i", " ", "=", " ", "1"}], ",", " ", 
          RowBox[{"i", " ", "\[LessEqual]", " ", 
           RowBox[{"Length", "@", "vadjccws"}]}], ",", " ", 
          RowBox[{"i", "++"}], ",", " ", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"vi", " ", "=", " ", 
            RowBox[{
             RowBox[{
             "vadjccws", "\[LeftDoubleBracket]", "i", 
              "\[RightDoubleBracket]"}], "\[LeftDoubleBracket]", "1", 
             "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"v", " ", "=", " ", 
            RowBox[{
            "verts3d", "\[LeftDoubleBracket]", "vi", 
             "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"adjV", " ", "=", " ", 
            RowBox[{
             RowBox[{"GetAdj", "[", 
              RowBox[{"{", "vi", "}"}], "]"}], "\[LeftDoubleBracket]", "2", 
             "\[RightDoubleBracket]"}]}], ";", " ", 
           RowBox[{"(*", 
            RowBox[{"list", " ", "of", " ", "adj", " ", "verts"}], "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{"debug", ",", 
               RowBox[{"Print", "[", 
                RowBox[{"\"\<i,vi,v,adjV\>\"", ",", " ", 
                 RowBox[{"{", 
                  RowBox[{"i", ",", "vi", ",", "v", ",", "adjV"}], "}"}]}], 
                "]"}]}], "]"}], ";"}], "*)"}], "\[IndentingNewLine]", 
           RowBox[{"nvec", " ", "=", " ", 
            RowBox[{
            "norms", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}],
            ";", " ", 
           RowBox[{"(*", 
            RowBox[{"nvecs", " ", "of", " ", "v"}], " ", "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{"ilist", "=", 
            RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{
             "loop", " ", "through", " ", "adjacent", " ", "vertices"}], ",", 
             " ", 
             RowBox[{"rotate", " ", "as", " ", "necessary"}]}], "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{"For", " ", "[", 
            RowBox[{
             RowBox[{"j", " ", "=", " ", "1"}], ",", " ", 
             RowBox[{"j", " ", "\[LessEqual]", " ", 
              RowBox[{"Length", "@", "adjV"}]}], ",", " ", 
             RowBox[{"j", "++"}], ",", " ", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"p", " ", "=", " ", 
               RowBox[{"verts3d", "\[LeftDoubleBracket]", 
                RowBox[{
                "adjV", "\[LeftDoubleBracket]", "j", 
                 "\[RightDoubleBracket]"}], "\[RightDoubleBracket]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"FuzzEqVec", "[", 
                  RowBox[{"nvec", ",", " ", 
                   RowBox[{"{", 
                    RowBox[{"0", ",", " ", "0", ",", " ", "1"}], "}"}]}], 
                  "]"}], " ", "||", " ", 
                 RowBox[{"FuzzEqVec", "[", 
                  RowBox[{"nvec", ",", " ", 
                   RowBox[{"{", 
                    RowBox[{"0", ",", " ", "0", ",", " ", 
                    RowBox[{"-", "1"}]}], "}"}]}], "]"}]}], ",", " ", 
                "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"ptrans", "=", " ", 
                  RowBox[{"p", "-", "v"}]}], ";", "\[IndentingNewLine]", 
                 RowBox[{"AppendTo", "[", 
                  RowBox[{"transList", ",", " ", 
                   RowBox[{"{", 
                    RowBox[{"vi", ",", " ", 
                    RowBox[{"FuzzZeroSub1", "[", "ptrans", "]"}]}], "}"}]}], 
                  "]"}], ";", "\[IndentingNewLine]", 
                 RowBox[{"AppendTo", "[", 
                  RowBox[{"ilist", ",", "ptrans"}], "]"}]}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"(*", 
                 RowBox[{"begin", " ", "else"}], "*)"}], 
                "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"rt", "=", 
                  RowBox[{"RotationTransform", "[", 
                   RowBox[{"{", 
                    RowBox[{"nvec", ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "}"}], 
                   "]"}]}], ";", "\[IndentingNewLine]", 
                 RowBox[{"ptrans", " ", "=", " ", 
                  RowBox[{"rt", "[", 
                   RowBox[{"p", "-", " ", "v"}], "]"}]}], ";", 
                 "\[IndentingNewLine]", "\[IndentingNewLine]", 
                 RowBox[{"AppendTo", "[", 
                  RowBox[{"transList", ",", "  ", 
                   RowBox[{"{", 
                    RowBox[{"vi", ",", " ", 
                    RowBox[{"FuzzZeroSub1", "[", "ptrans", "]"}]}], "}"}]}], 
                  "]"}], ";", " ", 
                 RowBox[{"(*", 
                  RowBox[{
                   RowBox[{"list", " ", "of", " ", "lists"}], ",", " ", 
                   RowBox[{
                   "one", " ", "trans", " ", "list", " ", "per", " ", 
                    "vertex"}]}], "*)"}], "\[IndentingNewLine]", 
                 RowBox[{"AppendTo", "[", 
                  RowBox[{"ilist", ",", "ptrans"}], "]"}], ";"}]}], 
               "\[IndentingNewLine]", "]"}], ";"}]}], " ", 
            RowBox[{"(*", 
             RowBox[{"end", " ", "if"}], "*)"}], "\[IndentingNewLine]", 
            "\[IndentingNewLine]", "]"}], ";", " ", 
           RowBox[{"(*", 
            RowBox[{"end", " ", "j"}], "*)"}], "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"Print", "[", 
              RowBox[{"vi", ",", " ", "ilist"}], "]"}], ";"}], "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{"AppendTo", "[", 
            RowBox[{"glist", ",", " ", "ilist"}], "]"}], ";"}]}], 
         "\[IndentingNewLine]", "]"}], ";", " ", 
        RowBox[{"(*", 
         RowBox[{"end", " ", "i"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "glist", "]"}], ";"}]}], "\[IndentingNewLine]",
       "]"}]}], ";"}], " ", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"debug", " ", "=", " ", "True"}], ";"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"TransCoords", "[", "]"}], " ", "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.753366143332996*^9, 3.753366236376105*^9}, {
   3.7533664520046473`*^9, 3.7533664868044615`*^9}, {3.7533665298352737`*^9, 
   3.7533665730021524`*^9}, {3.7533666471505823`*^9, 
   3.7533666822824965`*^9}, {3.753366727706234*^9, 3.753366760777155*^9}, {
   3.7533668350358887`*^9, 3.7533669945778522`*^9}, {3.7533671615485497`*^9, 
   3.7533671819602666`*^9}, {3.7533673949793935`*^9, 
   3.7533674268834467`*^9}, {3.7533674734196634`*^9, 
   3.7533675196411304`*^9}, {3.753367557905466*^9, 3.7533675735624857`*^9}, {
   3.753367646860736*^9, 3.7533678733845863`*^9}, {3.7533679651533747`*^9, 
   3.753368095983431*^9}, {3.7533681670800924`*^9, 3.7533681743070374`*^9}, {
   3.753368221574725*^9, 3.7533682992173715`*^9}, {3.7533683931621623`*^9, 
   3.753368450602603*^9}, {3.753368635779608*^9, 3.75336873310176*^9}, {
   3.753368825001628*^9, 3.7533688557319007`*^9}, {3.7533690090518265`*^9, 
   3.7533690109465322`*^9}, {3.753369061108884*^9, 3.753369221407793*^9}, {
   3.753369256088544*^9, 3.7533693244930806`*^9}, {3.753369629517062*^9, 
   3.753369632782772*^9}, {3.753466913764884*^9, 3.7534669554409246`*^9}, {
   3.7534676559188595`*^9, 3.7534676588625975`*^9}, {3.75346783491735*^9, 
   3.7534678533174915`*^9}, {3.7534678837152405`*^9, 
   3.7534679034105897`*^9}, {3.7534692036141624`*^9, 
   3.7534692158301153`*^9}, {3.7534692490794783`*^9, 3.753469256258403*^9}, {
   3.753469297084361*^9, 3.7534693440656753`*^9}, {3.7534738567087874`*^9, 
   3.753473889286643*^9}, {3.755374909558054*^9, 3.7553749269755464`*^9}, 
   3.756506746330332*^9, 3.7565068785539284`*^9, 3.756506918116104*^9, 
   3.756507133348378*^9, 3.757701859027301*^9, {3.7577865568890934`*^9, 
   3.757786566217187*^9}, {3.757786604208824*^9, 3.757786668317883*^9}, {
   3.757786708712905*^9, 3.75778672991201*^9}, {3.7582096530630145`*^9, 
   3.758209659678221*^9}, {3.75820988287963*^9, 3.7582100597376423`*^9}, {
   3.758210443023506*^9, 3.758210447021813*^9}, {3.7590825179619784`*^9, 
   3.759082648228428*^9}, {3.7590828173120637`*^9, 3.7590829471427174`*^9}, {
   3.7590829926739025`*^9, 3.759083156127535*^9}, {3.7591709345159407`*^9, 
   3.759170946200856*^9}, {3.7591710167905364`*^9, 3.7591711136374607`*^9}, {
   3.7591711496595564`*^9, 3.7591711553007736`*^9}, {3.7591712002329063`*^9, 
   3.7591712228722725`*^9}, {3.7591712898707285`*^9, 3.759171313785506*^9}, {
   3.7591715807163134`*^9, 3.7591715884458866`*^9}, 3.7591718712770896`*^9},
 CellLabel->
  "In[316]:=",ExpressionUUID->"f4fcba5f-8d66-49ba-a2c8-0ebf52cb7dbf"],

Cell[BoxData[
 Graphics3DBox[{
   {Opacity[0.5], 
    GraphicsComplex3DBox[{{0., 0., 
     0.6123724356957945}, {-0.2886751345948129, -0.5, -0.20412414523193154`}, \
{-0.2886751345948129, 0.5, -0.20412414523193154`}, {0.5773502691896258, 
     0., -0.20412414523193154`}}, 
     Polygon3DBox[{{2, 4, 1}, {4, 3, 1}, {2, 3, 4}, {1, 3, 2}}]]}, 
   {RGBColor[0, 0, 1], Text3DBox["1", {0., 0., 0.6123724356957945}], 
    Text3DBox["2", {-0.2886751345948129, -0.5, -0.20412414523193154`}], 
    Text3DBox["3", {-0.2886751345948129, 0.5, -0.20412414523193154`}], 
    Text3DBox["4", {0.5773502691896258, 0., -0.20412414523193154`}]}, {
    Arrow3DBox[{{0., 0., 0.6123724356957945}, {0., 0., 1.6123724356957945`}}],
     Arrow3DBox[{{-0.2886751345948129, -0.5, -0.20412414523193154`}, \
{-0.7600796553858444, -1.316496580927726, -0.5374574785652648}}], 
    Arrow3DBox[{{-0.2886751345948129, 
     0.5, -0.20412414523193154`}, {-0.7600796553858444, 
     1.316496580927726, -0.5374574785652649}}], 
    Arrow3DBox[{{0.5773502691896258, 0., -0.20412414523193154`}, {
     1.5201593107716893`, 0., -0.5374574785652649}}]}},
  ImageSize->{396.70452463558286`, 403.9025202739202},
  ImageSizeRaw->Automatic,
  ViewPoint->{2.3369687324087103`, -2.2650804844526027`, -0.9262761697765939},
  ViewVertical->{-0.07247514808733639, -0.7486387949827366, \
-0.8083320505792332}]], "Print",
 CellChangeTimes->{{3.758209889738889*^9, 3.7582099076051188`*^9}, 
   3.758553811058997*^9, 3.7585638443283987`*^9, 3.758564658080861*^9, 
   3.7590822297984514`*^9, {3.7590825581334743`*^9, 3.7590826038411884`*^9}, 
   3.7590826491030903`*^9, {3.7590828314592156`*^9, 3.7590828442629604`*^9}, {
   3.7590828783008957`*^9, 3.759082886845036*^9}, 3.75908302586005*^9, {
   3.759083074383234*^9, 3.759083082949314*^9}, {3.759083118495217*^9, 
   3.7590831563938227`*^9}, 3.7591683353133106`*^9, 3.7591712242436466`*^9, 
   3.759171321205203*^9, 3.7591715972364736`*^9, 3.759407200300926*^9, 
   3.759849045762887*^9, 3.7602005154573126`*^9, 3.7602013262649546`*^9, 
   3.7602017574297433`*^9},
 CellLabel->
  "During evaluation of \
In[316]:=",ExpressionUUID->"0c0334b0-12f1-4c48-81d6-2b317f685bf8"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "0.2886751345948129`"}], ",", 
       RowBox[{"-", "0.5`"}], ",", 
       RowBox[{"-", "0.816496580927726`"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0.5773502691896258`", ",", "0.`", ",", 
       RowBox[{"-", "0.816496580927726`"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "0.2886751345948129`"}], ",", "0.5`", ",", 
       RowBox[{"-", "0.816496580927726`"}]}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0.2886751345948132`", ",", 
       RowBox[{"-", "0.5`"}], ",", 
       RowBox[{"-", "0.8164965809277259`"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0.28867513459481287`", ",", "0.5`", ",", 
       RowBox[{"-", "0.8164965809277258`"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "0.5773502691896257`"}], ",", "2.7755575615628914`*^-17", 
       ",", 
       RowBox[{"-", "0.8164965809277259`"}]}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0.2886751345948131`", ",", "0.5000000000000001`", ",", 
       RowBox[{"-", "0.8164965809277264`"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0.288675134594813`", ",", 
       RowBox[{"-", "0.5000000000000001`"}], ",", 
       RowBox[{"-", "0.8164965809277265`"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "0.5773502691896257`"}], ",", "5.551115123125783`*^-17", 
       ",", 
       RowBox[{"-", "0.8164965809277264`"}]}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0.28867513459481314`", ",", 
       RowBox[{"-", "0.5`"}], ",", 
       RowBox[{"-", "0.8164965809277267`"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "0.5773502691896261`"}], ",", "9.686109391259852`*^-48", 
       ",", 
       RowBox[{"-", "0.8164965809277266`"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0.28867513459481314`", ",", "0.5`", ",", 
       RowBox[{"-", "0.8164965809277267`"}]}], "}"}]}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.7577866692952547`*^9, 3.7582096365241437`*^9, 3.7582098542664227`*^9, {
   3.7582098901787186`*^9, 3.758209907622079*^9}, 3.7585538115736084`*^9, 
   3.7585638447255573`*^9, 3.7585646580865836`*^9, 3.759082230199379*^9, {
   3.7590825583439035`*^9, 3.7590826038591366`*^9}, 3.7590826491340065`*^9, {
   3.7590828314831514`*^9, 3.7590828442829075`*^9}, {3.7590828783218718`*^9, 
   3.7590828868640327`*^9}, 3.7590830258799953`*^9, {3.75908307440123*^9, 
   3.759083082968293*^9}, {3.7590831185161896`*^9, 3.7590831564138193`*^9}, 
   3.7591683356576443`*^9, 3.759171224269431*^9, 3.7591713212363486`*^9, 
   3.759171597262991*^9, 3.759407200660673*^9, 3.7598490469828024`*^9, 
   3.760200516411327*^9, 3.7602013262828097`*^9, 3.760201757448197*^9},
 CellLabel->
  "Out[317]=",ExpressionUUID->"46c4fbb6-6b57-484e-983b-a4e7ecff497d"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Step 3: Use a \[OpenCurlyQuote]least squares\[CloseCurlyQuote] method to find \
a fitting quadratic for the polyhedron\
\>", "Section",
 CellChangeTimes->{{3.7565103159915457`*^9, 3.7565103161369925`*^9}, {
  3.7565105218279486`*^9, 3.7565105220279045`*^9}, {3.757786243285779*^9, 
  3.7577862914976635`*^9}, {3.757786592515772*^9, 
  3.7577865952483096`*^9}},ExpressionUUID->"ec0b91e3-6ca1-4640-9476-\
f0b31b3d8e39"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "takes", " ", "in", " ", "a", " ", "single", " ", "pt", " ", "and", " ", 
    "fits", " ", "it"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"FitSingle", "[", "pt_", "]"}], " ", ":=", " ", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "eq", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"abc", " ", "=", " ", 
         RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"eq", " ", "=", " ", 
         RowBox[{"Fit", "[", 
          RowBox[{"pt", ",", " ", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"x", "^", "2"}], ",", " ", 
             RowBox[{"x", " ", "y"}], ",", " ", 
             RowBox[{"y", "^", "2"}]}], "}"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"x", ",", " ", "y"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{"\"\<eq = \>\"", ",", " ", "eq"}], "]"}], ";"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{"\"\<eq1 =\>\"", ",", " ", 
            RowBox[{
            "eq", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
           "]"}], ";"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
           "eq", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], " ", 
           "\[NotEqual]", " ", "0"}], ",", "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{"Print", "[", 
             RowBox[{"\"\<eq11 =\>\"", ",", " ", 
              RowBox[{
               RowBox[{
               "eq", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
               "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
             "]"}], ";"}], " ", "*)"}], "\[IndentingNewLine]", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"abc", ",", " ", 
            RowBox[{
             RowBox[{
             "eq", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
             "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], "]"}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"(*", "else", "*)"}], "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{"Print", "[", 
             RowBox[{"\"\<eq1 = \>\"", ",", " ", 
              RowBox[{
              "eq", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
             "]"}], ";"}], "*)"}], "\[IndentingNewLine]", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"abc", ",", " ", 
            RowBox[{
            "eq", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
           "]"}], ",", " ", "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{"uneval", " ", "condition"}], "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"AppendTo", "[", 
            RowBox[{"abc", ",", " ", 
             RowBox[{
              RowBox[{
              "eq", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
              "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], "]"}],
            ";"}]}], "\[IndentingNewLine]", "]"}], ";", " ", 
        RowBox[{"(*", 
         RowBox[{"end", " ", "if"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"abc", ",", " ", 
          RowBox[{
           RowBox[{
           "eq", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
           "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], "]"}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{"\"\<eq2 = \>\"", ",", " ", 
            RowBox[{
             RowBox[{
             "eq", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
             "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], "]"}], 
          ";"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"abc", ",", " ", 
          RowBox[{
           RowBox[{
           "eq", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], 
           "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], "]"}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{"\"\<eq3 = \>\"", ",", " ", 
            RowBox[{
             RowBox[{
             "eq", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], 
             "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], "]"}], 
          ";"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "abc", "]"}], ";"}]}], "\[IndentingNewLine]", 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"FitSingle", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0.2886751345948132`", ",", 
         RowBox[{"-", "0.5`"}], ",", 
         RowBox[{"-", "0.8164965809277259`"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0.28867513459481287`", ",", "0.5`", ",", 
         RowBox[{"-", "0.8164965809277258`"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "0.5773502691896257`"}], ",", 
         "2.7755575615628914`*^-17", ",", 
         RowBox[{"-", "0.8164965809277259`"}]}], "}"}]}], "}"}], "]"}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"FitSingle", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0.28867513459481314`", ",", 
         RowBox[{"-", "0.5`"}], ",", 
         RowBox[{"-", "0.8164965809277267`"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "0.5773502691896261`"}], ",", "9.686109391259852`*^-48",
          ",", 
         RowBox[{"-", "0.8164965809277266`"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0.28867513459481314`", ",", "0.5`", ",", 
         RowBox[{"-", "0.8164965809277267`"}]}], "}"}]}], "}"}], "]"}], " ", 
    "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "takes", " ", "in", " ", "a", " ", "list", " ", "of", " ", "pts", " ", 
      "and", " ", "fits", " ", "them"}], ",", " ", 
     RowBox[{"returning", " ", "their", " ", "coefficients"}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"FitList", "[", "ptList_", "]"}], " ", ":=", " ", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "input", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"abcList", " ", "=", " ", 
         RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"i", "=", "1"}], ",", " ", 
          RowBox[{"i", "\[LessEqual]", 
           RowBox[{"Length", "@", "ptList"}]}], ",", " ", 
          RowBox[{"i", "++"}], ",", " ", "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{"Print", "[", 
             RowBox[{"\"\<fitting \>\"", ",", 
              RowBox[{
              "ptList", "\[LeftDoubleBracket]", "i", 
               "\[RightDoubleBracket]"}]}], "]"}], ";"}], "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"fittedPt", " ", "=", " ", 
            RowBox[{"FitSingle", "[", 
             RowBox[{
             "ptList", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}],
              "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"Print", "[", 
              RowBox[{"\"\<fittedpt = \>\"", ",", " ", "fittedPt"}], "]"}], 
             ";"}], "*)"}], "\[IndentingNewLine]", 
           RowBox[{"AppendTo", "[", 
            RowBox[{"abcList", ",", " ", "fittedPt"}], "]"}]}]}], 
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "abcList", "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"FitList", "[", "glist", "]"}], "*)"}], 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{
  3.7591706227624407`*^9, {3.7591713545703816`*^9, 3.759171416999729*^9}, {
   3.7591714789693117`*^9, 3.759171502904952*^9}, {3.7591715555745115`*^9, 
   3.759171557566783*^9}, {3.759171630309342*^9, 3.759171635158881*^9}, 
   3.759171670072012*^9, {3.7594074080977564`*^9, 3.7594075901770835`*^9}, {
   3.759407633211118*^9, 3.7594076714410295`*^9}, {3.759407783878174*^9, 
   3.7594078436612005`*^9}, {3.759407921583354*^9, 3.759408133723833*^9}, {
   3.759408301707999*^9, 3.75940831484565*^9}, {3.7594083642069864`*^9, 
   3.759408506723507*^9}, {3.7594085771452703`*^9, 3.7594086543160963`*^9}, {
   3.759408695442656*^9, 3.7594087274328575`*^9}, {3.7594088242387543`*^9, 
   3.7594088244101973`*^9}, {3.759408881301506*^9, 3.759408888973186*^9}, {
   3.7594092154795685`*^9, 3.759409242864661*^9}, 3.7602013452944365`*^9, {
   3.7602013993471727`*^9, 3.760201433509118*^9}, {3.7602014940232897`*^9, 
   3.760201510341484*^9}, 3.76020155128459*^9, {3.760201953305802*^9, 
   3.760202010639059*^9}, {3.7602021075073185`*^9, 3.76020220007861*^9}, {
   3.760202230819825*^9, 3.760202231021854*^9}, {3.7602022653892813`*^9, 
   3.760202285961669*^9}, {3.760202342839723*^9, 3.760202402054137*^9}, {
   3.760202448957925*^9, 3.7602025211896143`*^9}, {3.7602025573982935`*^9, 
   3.7602025743790393`*^9}, 3.760202669941637*^9, {3.760203093265714*^9, 
   3.760203172662611*^9}, {3.760203223231917*^9, 
   3.760203230990712*^9}},ExpressionUUID->"deb2ecd5-9f8f-4441-8487-\
b8c35ece8332"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0.`", ",", 
     RowBox[{"-", "2.4494897427831774`"}], ",", 
     RowBox[{"-", "2.449489742783178`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "2.4494897427831788`"}], ",", 
     RowBox[{"-", "9.134689097773145`*^-16"}], ",", 
     RowBox[{"-", "2.449489742783177`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "2.449489742783179`"}], ",", "1.6316879466126209`*^-15", 
     ",", 
     RowBox[{"-", "2.4494897427831774`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "2.4494897427831774`"}], ",", "5.438959822042068`*^-16", 
     ",", 
     RowBox[{"-", "2.4494897427831805`"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.7602022009326715`*^9, 3.7602022313647113`*^9, {3.7602022675086603`*^9, 
   3.7602022864433055`*^9}, {3.7602023464739723`*^9, 3.760202402798463*^9}, 
   3.7602024523085856`*^9, 3.7602025235151525`*^9, 3.7602025751391153`*^9, {
   3.760203112652606*^9, 3.7602031284402437`*^9}, {3.76020316511597*^9, 
   3.7602031735391293`*^9}, 3.760203223970293*^9},
 CellLabel->
  "Out[390]=",ExpressionUUID->"cffa9a46-587d-430d-80ce-5a09d909ca1e"]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.7565066286701403`*^9, 3.7565066606393547`*^9}, {
   3.756506729354765*^9, 3.7565067390969706`*^9}, {3.756506786349352*^9, 
   3.756506865064988*^9}, {3.756506935208233*^9, 3.7565071027816734`*^9}, {
   3.756509894811224*^9, 3.7565099455233183`*^9}, {3.756509991657323*^9, 
   3.756510009960058*^9}, {3.7565101595144634`*^9, 3.756510286296158*^9}, 
   3.756510557243288*^9, {3.7569195693550606`*^9, 3.7569196887498226`*^9}, {
   3.756919777119655*^9, 3.756919829637525*^9}, {3.7569198834185095`*^9, 
   3.756919885574974*^9}, {3.75700044734836*^9, 3.7570005000766077`*^9}, {
   3.7570005582005816`*^9, 3.75700055997727*^9}, {3.757000886209112*^9, 
   3.7570008938167276`*^9}, 3.757004313776813*^9, 3.7570043516981764`*^9, {
   3.7570043820561237`*^9, 3.757004400850428*^9}, {3.7570044361240563`*^9, 
   3.7570044370308065`*^9}, {3.757004512571851*^9, 3.757004515756143*^9}, {
   3.7570045612686005`*^9, 3.757004639475606*^9}, {3.7570048255348425`*^9, 
   3.7570048439489017`*^9}, {3.7570958293749847`*^9, 3.757095948746505*^9}, {
   3.757096318333535*^9, 3.757096421398403*^9}, {3.7570964988532295`*^9, 
   3.757096532072553*^9}, {3.7570966309742737`*^9, 3.757096638384679*^9}, {
   3.757097911456375*^9, 3.757097916703086*^9}, {3.757097952688537*^9, 
   3.7570979621808915`*^9}, {3.7576019346388755`*^9, 
   3.7576019578028293`*^9}, {3.757602459027133*^9, 3.757602608546132*^9}, {
   3.7576027957963676`*^9, 3.757602817235137*^9}, {3.757701278397955*^9, 
   3.7577013109978013`*^9}, {3.7577013677697*^9, 3.757701396054205*^9}, {
   3.757701969569997*^9, 3.757701972589522*^9}, {3.7577020395179543`*^9, 
   3.7577021222998843`*^9}, {3.757702188576311*^9, 3.7577021888576746`*^9}, 
   3.7577022220719624`*^9, {3.7577022809917774`*^9, 3.7577022886252346`*^9}, {
   3.7577025918930087`*^9, 3.757702610884173*^9}, {3.7577839197268667`*^9, 
   3.7577839492829847`*^9}, {3.7577841516116447`*^9, 3.7577841819641457`*^9}, 
   3.757784815630353*^9, {3.7577857496290874`*^9, 3.757785778006118*^9}, {
   3.757786435083334*^9, 3.7577865109761925`*^9}, 3.757786600416919*^9, {
   3.759085582917246*^9, 3.759085583586829*^9}},
 CellLabel->
  "In[321]:=",ExpressionUUID->"b3cdb057-db3d-45f1-9c96-75d5e549057b"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Step 4: Use the coeffs of the least-squares polynomial to compute pvecs\
\>", "Section",
 CellChangeTimes->{{3.7594131831397095`*^9, 3.7594132104536643`*^9}, {
  3.760205763843808*^9, 
  3.7602057668758*^9}},ExpressionUUID->"57d376b7-709c-4382-b9f0-e7ed18910f9a"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"GetDirections", "[", "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "x0", "}"}], ",", " ", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"fffMatList", " ", "=", " ", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"sffMatList", " ", "=", " ", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"Compute", " ", "FFF", " ", "and", " ", "matrix"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"fittedList", " ", "=", " ", 
       RowBox[{"FitList", "[", "glist", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Print", "[", "fittedList", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
        "REMEMBER", " ", "THAT", " ", "A", " ", "0", " ", "IN", " ", "POS", 
         " ", "1", " ", "MEANS", " ", "A", " ", "0", " ", "XY", " ", 
         "COORD"}], ",", " ", 
        RowBox[{"NOT", " ", "0", " ", "X", " ", "COORD"}]}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"For", " ", "[", 
       RowBox[{
        RowBox[{"i", " ", "=", " ", "1"}], ",", " ", 
        RowBox[{"i", "\[LessEqual]", " ", 
         RowBox[{"Length", "@", "fittedList"}]}], ",", " ", 
        RowBox[{"i", "++"}], ",", " ", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
             "fittedList", "\[LeftDoubleBracket]", "i", 
              "\[RightDoubleBracket]"}], "\[LeftDoubleBracket]", "1", 
             "\[RightDoubleBracket]"}], " ", "\[Equal]", " ", "0"}], ",", " ",
            "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Print", "[", "\"\<got a 0\>\"", "]"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"matF", " ", "=", " ", 
             RowBox[{
              RowBox[{
              "fittedList", "\[LeftDoubleBracket]", "i", 
               "\[RightDoubleBracket]"}], "\[LeftDoubleBracket]", "1", 
              "\[RightDoubleBracket]"}]}], " ", ";", " ", 
            "\[IndentingNewLine]", 
            RowBox[{"matE", " ", "=", " ", 
             RowBox[{
              RowBox[{
              "fittedList", "\[LeftDoubleBracket]", "i", 
               "\[RightDoubleBracket]"}], "\[LeftDoubleBracket]", "2", 
              "\[RightDoubleBracket]"}]}], ";", " ", "\[IndentingNewLine]", 
            RowBox[{"matG", " ", "=", " ", 
             RowBox[{
              RowBox[{
              "fittedList", "\[LeftDoubleBracket]", "i", 
               "\[RightDoubleBracket]"}], "\[LeftDoubleBracket]", "3", 
              "\[RightDoubleBracket]"}]}], " ", ";", "\[IndentingNewLine]", 
            RowBox[{"Print", "[", 
             RowBox[{
             "\"\<E = \>\"", ",", " ", "matE", ",", " ", "\"\<, F = \>\"", 
              ",", " ", "matF", ",", " ", "\"\<, G = \>\"", ",", " ", 
              "matG"}], "]"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"(*", "else", "*)"}], "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"matE", " ", "=", " ", 
             RowBox[{
              RowBox[{
              "fittedList", "\[LeftDoubleBracket]", "i", 
               "\[RightDoubleBracket]"}], "\[LeftDoubleBracket]", "1", 
              "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"matF", " ", "=", " ", 
             RowBox[{
              RowBox[{
              "fittedList", "\[LeftDoubleBracket]", "i", 
               "\[RightDoubleBracket]"}], "\[LeftDoubleBracket]", "2", 
              "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"matG", " ", "=", " ", 
             RowBox[{
              RowBox[{
              "fittedList", "\[LeftDoubleBracket]", "i", 
               "\[RightDoubleBracket]"}], "\[LeftDoubleBracket]", "3", 
              "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"Print", "[", 
             RowBox[{
             "\"\<E = \>\"", ",", " ", "matE", ",", " ", "\"\<, F = \>\"", 
              ",", " ", "matF", ",", " ", "\"\<, G = \>\"", ",", " ", 
              "matG"}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"fffMat", " ", "=", " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"matE", ",", " ", "matF"}], "}"}], ",", " ", 
            RowBox[{"{", 
             RowBox[{"matF", ",", " ", "matG"}], "}"}]}], "}"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Print", "[", 
          RowBox[{"fffMat", "//", "MatrixForm"}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"AppendTo", "[", 
          RowBox[{"fffMatList", ",", " ", "fffMat"}], "]"}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"Print", "[", "fffMatList", "]"}], ";"}], "*)"}], 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"Compute", " ", "SFF", " ", "and", " ", "matrix"}], "*)"}], 
    "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"compute", " ", "A"}], "*)"}], "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"get", " ", "eigenvectors"}], "*)"}], "\[IndentingNewLine]", 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"GetDirections", "[", "]"}]}], "Input",
 CellChangeTimes->{{3.757601271144764*^9, 3.7576012800070715`*^9}, 
   3.7577861455465517`*^9, {3.759413215069352*^9, 3.759413216211266*^9}, {
   3.7598499409790344`*^9, 3.759849976372384*^9}, {3.759850661865189*^9, 
   3.7598506806239834`*^9}, {3.759856417987213*^9, 3.7598564434385185`*^9}, {
   3.7602013074292765`*^9, 3.7602013215002165`*^9}, {3.760203236829192*^9, 
   3.7602032931990843`*^9}, {3.760204014564479*^9, 3.760204043116705*^9}, {
   3.76020411753529*^9, 3.760204128686513*^9}, {3.7602041621813135`*^9, 
   3.7602042996890235`*^9}, {3.7602043630156794`*^9, 
   3.7602043881667905`*^9}, {3.760204443510968*^9, 3.7602046444560556`*^9}, {
   3.760204675248032*^9, 3.760204902590335*^9}, {3.7602049390857887`*^9, 
   3.760205009279229*^9}, {3.7602147777019043`*^9, 3.7602147837576904`*^9}},
 CellLabel->
  "In[458]:=",ExpressionUUID->"f3c8b13d-1901-4ba5-a59d-766bc8143702"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0.`", ",", 
     RowBox[{"-", "2.4494897427831774`"}], ",", 
     RowBox[{"-", "2.449489742783178`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "2.4494897427831788`"}], ",", 
     RowBox[{"-", "9.134689097773145`*^-16"}], ",", 
     RowBox[{"-", "2.449489742783177`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "2.449489742783179`"}], ",", "1.6316879466126209`*^-15", 
     ",", 
     RowBox[{"-", "2.4494897427831774`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "2.4494897427831774`"}], ",", "5.438959822042068`*^-16", 
     ",", 
     RowBox[{"-", "2.4494897427831805`"}]}], "}"}]}], "}"}]], "Print",
 CellChangeTimes->{
  3.760203293600149*^9, 3.7602043009098654`*^9, {3.76020436976939*^9, 
   3.760204406052744*^9}, {3.7602044545516624`*^9, 3.7602044905447483`*^9}, {
   3.760204568587494*^9, 3.760204596167279*^9}, {3.7602046289424815`*^9, 
   3.7602047019844975`*^9}, {3.7602047625061483`*^9, 
   3.7602047695422397`*^9}, {3.7602048150524116`*^9, 
   3.7602049033504095`*^9}, {3.760204949050988*^9, 3.7602049634395633`*^9}, 
   3.760214792121333*^9},
 CellLabel->
  "During evaluation of \
In[458]:=",ExpressionUUID->"47da9ca8-6c4d-4611-b2f6-771714ffeb6a"],

Cell[BoxData["\<\"got a 0\"\>"], "Print",
 CellChangeTimes->{
  3.760203293600149*^9, 3.7602043009098654`*^9, {3.76020436976939*^9, 
   3.760204406052744*^9}, {3.7602044545516624`*^9, 3.7602044905447483`*^9}, {
   3.760204568587494*^9, 3.760204596167279*^9}, {3.7602046289424815`*^9, 
   3.7602047019844975`*^9}, {3.7602047625061483`*^9, 
   3.7602047695422397`*^9}, {3.7602048150524116`*^9, 
   3.7602049033504095`*^9}, {3.760204949050988*^9, 3.7602049634395633`*^9}, 
   3.760214792121333*^9},
 CellLabel->
  "During evaluation of \
In[458]:=",ExpressionUUID->"538cc410-583e-4679-9a07-f00d377f3dac"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"E = \"\>", "\[InvisibleSpace]", 
   RowBox[{"-", "2.4494897427831774`"}], 
   "\[InvisibleSpace]", "\<\", F = \"\>", "\[InvisibleSpace]", "0.`", 
   "\[InvisibleSpace]", "\<\", G = \"\>", "\[InvisibleSpace]", 
   RowBox[{"-", "2.449489742783178`"}]}],
  SequenceForm[
  "E = ", -2.4494897427831774`, ", F = ", 0., ", G = ", -2.449489742783178],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.760203293600149*^9, 3.7602043009098654`*^9, {3.76020436976939*^9, 
   3.760204406052744*^9}, {3.7602044545516624`*^9, 3.7602044905447483`*^9}, {
   3.760204568587494*^9, 3.760204596167279*^9}, {3.7602046289424815`*^9, 
   3.7602047019844975`*^9}, {3.7602047625061483`*^9, 
   3.7602047695422397`*^9}, {3.7602048150524116`*^9, 
   3.7602049033504095`*^9}, {3.760204949050988*^9, 3.7602049634395633`*^9}, 
   3.760214792127365*^9},
 CellLabel->
  "During evaluation of \
In[458]:=",ExpressionUUID->"a7d36572-7b03-40dd-aaa2-19ac0054d7de"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"-", "2.4494897427831774`"}], "0.`"},
     {"0.`", 
      RowBox[{"-", "2.449489742783178`"}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Print",
 CellChangeTimes->{
  3.760203293600149*^9, 3.7602043009098654`*^9, {3.76020436976939*^9, 
   3.760204406052744*^9}, {3.7602044545516624`*^9, 3.7602044905447483`*^9}, {
   3.760204568587494*^9, 3.760204596167279*^9}, {3.7602046289424815`*^9, 
   3.7602047019844975`*^9}, {3.7602047625061483`*^9, 
   3.7602047695422397`*^9}, {3.7602048150524116`*^9, 
   3.7602049033504095`*^9}, {3.760204949050988*^9, 3.7602049634395633`*^9}, 
   3.760214792130872*^9},
 CellLabel->
  "During evaluation of \
In[458]:=",ExpressionUUID->"af1aeb35-c992-47e6-8d74-64fdba9feafb"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"E = \"\>", "\[InvisibleSpace]", 
   RowBox[{"-", "2.4494897427831788`"}], 
   "\[InvisibleSpace]", "\<\", F = \"\>", "\[InvisibleSpace]", 
   RowBox[{"-", "9.134689097773145`*^-16"}], 
   "\[InvisibleSpace]", "\<\", G = \"\>", "\[InvisibleSpace]", 
   RowBox[{"-", "2.449489742783177`"}]}],
  SequenceForm[
  "E = ", -2.4494897427831788`, ", F = ", -9.134689097773145*^-16, 
   ", G = ", -2.449489742783177],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.760203293600149*^9, 3.7602043009098654`*^9, {3.76020436976939*^9, 
   3.760204406052744*^9}, {3.7602044545516624`*^9, 3.7602044905447483`*^9}, {
   3.760204568587494*^9, 3.760204596167279*^9}, {3.7602046289424815`*^9, 
   3.7602047019844975`*^9}, {3.7602047625061483`*^9, 
   3.7602047695422397`*^9}, {3.7602048150524116`*^9, 
   3.7602049033504095`*^9}, {3.760204949050988*^9, 3.7602049634395633`*^9}, 
   3.760214792130872*^9},
 CellLabel->
  "During evaluation of \
In[458]:=",ExpressionUUID->"49442b65-e7f4-4063-ad9a-5fdaefd629a6"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"-", "2.4494897427831788`"}], 
      RowBox[{"-", "9.134689097773145`*^-16"}]},
     {
      RowBox[{"-", "9.134689097773145`*^-16"}], 
      RowBox[{"-", "2.449489742783177`"}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Print",
 CellChangeTimes->{
  3.760203293600149*^9, 3.7602043009098654`*^9, {3.76020436976939*^9, 
   3.760204406052744*^9}, {3.7602044545516624`*^9, 3.7602044905447483`*^9}, {
   3.760204568587494*^9, 3.760204596167279*^9}, {3.7602046289424815`*^9, 
   3.7602047019844975`*^9}, {3.7602047625061483`*^9, 
   3.7602047695422397`*^9}, {3.7602048150524116`*^9, 
   3.7602049033504095`*^9}, {3.760204949050988*^9, 3.7602049634395633`*^9}, 
   3.760214792141128*^9},
 CellLabel->
  "During evaluation of \
In[458]:=",ExpressionUUID->"0e5a292f-16dc-4214-ba0b-14b4c5da2d61"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"E = \"\>", "\[InvisibleSpace]", 
   RowBox[{"-", "2.449489742783179`"}], "\[InvisibleSpace]", "\<\", F = \"\>",
    "\[InvisibleSpace]", "1.6316879466126209`*^-15", 
   "\[InvisibleSpace]", "\<\", G = \"\>", "\[InvisibleSpace]", 
   RowBox[{"-", "2.4494897427831774`"}]}],
  SequenceForm[
  "E = ", -2.449489742783179, ", F = ", 1.6316879466126209`*^-15, 
   ", G = ", -2.4494897427831774`],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.760203293600149*^9, 3.7602043009098654`*^9, {3.76020436976939*^9, 
   3.760204406052744*^9}, {3.7602044545516624`*^9, 3.7602044905447483`*^9}, {
   3.760204568587494*^9, 3.760204596167279*^9}, {3.7602046289424815`*^9, 
   3.7602047019844975`*^9}, {3.7602047625061483`*^9, 
   3.7602047695422397`*^9}, {3.7602048150524116`*^9, 
   3.7602049033504095`*^9}, {3.760204949050988*^9, 3.7602049634395633`*^9}, 
   3.760214792141128*^9},
 CellLabel->
  "During evaluation of \
In[458]:=",ExpressionUUID->"dff83325-e690-43c8-9101-c1d563c052b5"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"-", "2.449489742783179`"}], "1.6316879466126209`*^-15"},
     {"1.6316879466126209`*^-15", 
      RowBox[{"-", "2.4494897427831774`"}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Print",
 CellChangeTimes->{
  3.760203293600149*^9, 3.7602043009098654`*^9, {3.76020436976939*^9, 
   3.760204406052744*^9}, {3.7602044545516624`*^9, 3.7602044905447483`*^9}, {
   3.760204568587494*^9, 3.760204596167279*^9}, {3.7602046289424815`*^9, 
   3.7602047019844975`*^9}, {3.7602047625061483`*^9, 
   3.7602047695422397`*^9}, {3.7602048150524116`*^9, 
   3.7602049033504095`*^9}, {3.760204949050988*^9, 3.7602049634395633`*^9}, 
   3.760214792147178*^9},
 CellLabel->
  "During evaluation of \
In[458]:=",ExpressionUUID->"c8124171-2890-4447-933d-6eec6cef6a51"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"E = \"\>", "\[InvisibleSpace]", 
   RowBox[{"-", "2.4494897427831774`"}], 
   "\[InvisibleSpace]", "\<\", F = \"\>", "\[InvisibleSpace]", 
   "5.438959822042068`*^-16", "\[InvisibleSpace]", "\<\", G = \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"-", "2.4494897427831805`"}]}],
  SequenceForm[
  "E = ", -2.4494897427831774`, ", F = ", 5.438959822042068*^-16, 
   ", G = ", -2.4494897427831805`],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.760203293600149*^9, 3.7602043009098654`*^9, {3.76020436976939*^9, 
   3.760204406052744*^9}, {3.7602044545516624`*^9, 3.7602044905447483`*^9}, {
   3.760204568587494*^9, 3.760204596167279*^9}, {3.7602046289424815`*^9, 
   3.7602047019844975`*^9}, {3.7602047625061483`*^9, 
   3.7602047695422397`*^9}, {3.7602048150524116`*^9, 
   3.7602049033504095`*^9}, {3.760204949050988*^9, 3.7602049634395633`*^9}, 
   3.760214792147178*^9},
 CellLabel->
  "During evaluation of \
In[458]:=",ExpressionUUID->"9f132c33-68bd-44da-946b-d7d9d031b0d1"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"-", "2.4494897427831774`"}], "5.438959822042068`*^-16"},
     {"5.438959822042068`*^-16", 
      RowBox[{"-", "2.4494897427831805`"}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Print",
 CellChangeTimes->{
  3.760203293600149*^9, 3.7602043009098654`*^9, {3.76020436976939*^9, 
   3.760204406052744*^9}, {3.7602044545516624`*^9, 3.7602044905447483`*^9}, {
   3.760204568587494*^9, 3.760204596167279*^9}, {3.7602046289424815`*^9, 
   3.7602047019844975`*^9}, {3.7602047625061483`*^9, 
   3.7602047695422397`*^9}, {3.7602048150524116`*^9, 
   3.7602049033504095`*^9}, {3.760204949050988*^9, 3.7602049634395633`*^9}, 
   3.760214792147178*^9},
 CellLabel->
  "During evaluation of \
In[458]:=",ExpressionUUID->"a6b9cdb1-9b08-4558-92ab-c7e4cc8e1bb7"]
}, Open  ]]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.7576012911133833`*^9, 3.7576013050421486`*^9}, 
   3.7577861436333027`*^9},
 CellLabel->
  "In[323]:=",ExpressionUUID->"f2e83408-d9e5-425b-b268-3c0bf8b60cbb"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.7577027807346425`*^9, 3.757702794026758*^9}, 
   3.7577861414395127`*^9},
 CellLabel->
  "In[324]:=",ExpressionUUID->"31b581fe-5ef1-477a-8f08-10fc7dbfc5ed"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"OLD", " ", "DISTANCE", " ", "METHOD"}], ",", " ", 
    RowBox[{"NOT", " ", "NEEDED"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "This", " ", "function", " ", "computes", " ", "the", " ", "distance", 
     " ", "of", " ", "each", " ", "pt", " ", "to", " ", "the", " ", "plane"}],
     "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"PtPlaneDist", "[", "]"}], " ", ":=", " ", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "v", ",", " ", "w", ",", " ", "i", ",", " ", "j", ",", " ", "vi"}], 
        "}"}], ",", " ", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"norms", " ", "=", " ", 
         RowBox[{"GetNormal", "[", "]"}]}], ";", 
        RowBox[{"(*", 
         RowBox[{
         "calculate", " ", "normal", " ", "vectors", " ", "for", " ", "each", 
          " ", "v"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"i", "=", "1"}], ",", " ", 
          RowBox[{"i", "\[LessEqual]", " ", 
           RowBox[{"Length", "@", "vadjccws"}]}], ",", " ", 
          RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"dists", " ", "=", " ", 
            RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"vi", " ", "=", " ", 
            RowBox[{
             RowBox[{
             "vadjccws", "\[LeftDoubleBracket]", "i", 
              "\[RightDoubleBracket]"}], "\[LeftDoubleBracket]", "1", 
             "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"adjV", " ", "=", " ", 
            RowBox[{
             RowBox[{"GetAdj", "[", 
              RowBox[{"{", "vi", "}"}], "]"}], "\[LeftDoubleBracket]", "2", 
             "\[RightDoubleBracket]"}]}], ";", " ", 
           RowBox[{"(*", 
            RowBox[{"list", " ", "of", " ", "adj", " ", "vertices"}], "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{"For", " ", "[", 
            RowBox[{
             RowBox[{"j", " ", "=", " ", "1"}], ",", " ", 
             RowBox[{"j", "\[LessEqual]", " ", 
              RowBox[{"Length", "@", "adjV"}]}], ",", " ", 
             RowBox[{"j", "++"}], ",", " ", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"w", " ", "=", " ", 
               RowBox[{"verts3d", "\[LeftDoubleBracket]", 
                RowBox[{
                "adjV", "\[LeftDoubleBracket]", "j", 
                 "\[RightDoubleBracket]"}], "\[RightDoubleBracket]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"(*", 
               RowBox[{
                RowBox[{"Print", "[", "w", "]"}], ";"}], "*)"}], 
              "\[IndentingNewLine]", 
              RowBox[{"height", " ", "=", " ", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"w", "-", 
                  RowBox[{
                  "verts3d", "\[LeftDoubleBracket]", "vi", 
                   "\[RightDoubleBracket]"}]}], ")"}], ".", 
                RowBox[{
                "norms", "\[LeftDoubleBracket]", "vi", 
                 "\[RightDoubleBracket]"}]}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"AppendTo", "[", 
               RowBox[{"dists", ",", " ", "height"}], "]"}], ";"}]}], 
            "\[IndentingNewLine]", "]"}], ";"}]}], " ", 
         RowBox[{"(*", 
          RowBox[{"end", " ", "forj"}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"Print", "[", "dists", "]"}], ";"}], "*)"}], 
         "\[IndentingNewLine]", "]"}], ";", " ", 
        RowBox[{"(*", 
         RowBox[{"end", " ", "fori"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"Print", "[", "dists", "]"}], ";"}]}], "\[IndentingNewLine]", 
      "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"PtPlaneDist", "[", "]"}], ";"}], "*)"}]}]], "Input",
 CellChangeTimes->{{3.7582100299653187`*^9, 3.7582100307612886`*^9}},
 CellLabel->
  "In[325]:=",ExpressionUUID->"3a0a429a-b833-471e-8b48-19144756747e"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1536, 781},
WindowMargins->{{-8, Automatic}, {Automatic, -8}},
FrontEndVersion->"11.3 for Microsoft Windows (64-bit) (March 6, 2018)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 773, 15, 285, "Title",ExpressionUUID->"6ec8c87a-ce39-48c1-a77d-1e8562fb4ed0"],
Cell[CellGroupData[{
Cell[1378, 41, 448, 6, 67, "Section",ExpressionUUID->"55c19859-bd91-4eaf-a717-4f6b2d552445"],
Cell[1829, 49, 175, 3, 28, "Input",ExpressionUUID->"afd995fb-d4dc-4cf8-ab61-607c75bb165a"],
Cell[CellGroupData[{
Cell[2029, 56, 13472, 252, 979, "Input",ExpressionUUID->"7409b5de-f013-481e-adc3-3eadfc67703e"],
Cell[15504, 310, 2285, 37, 393, "Print",ExpressionUUID->"dcfdc30e-e696-4563-9082-a31e5f3f6cda"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[17838, 353, 395, 8, 105, "Section",ExpressionUUID->"6f3d8367-ffa0-4608-b86c-1badf0f55516"],
Cell[18236, 363, 6598, 134, 409, "Input",ExpressionUUID->"8234589e-3f4f-4620-9bae-162c02254800"],
Cell[24837, 499, 2540, 57, 219, "Input",ExpressionUUID->"63788c11-9339-4554-a838-12d2506987ab"],
Cell[27380, 558, 252, 5, 28, "Input",ExpressionUUID->"08b05fe8-16e4-43b7-b2a0-1ea6cc5fec3c"],
Cell[CellGroupData[{
Cell[27657, 567, 10987, 224, 770, "Input",ExpressionUUID->"f4fcba5f-8d66-49ba-a2c8-0ebf52cb7dbf"],
Cell[38647, 793, 2168, 37, 412, "Print",ExpressionUUID->"0c0334b0-12f1-4c48-81d6-2b317f685bf8"],
Cell[40818, 832, 3004, 72, 59, "Output",ExpressionUUID->"46c4fbb6-6b57-484e-983b-a4e7ecff497d"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[43871, 910, 427, 8, 67, "Section",ExpressionUUID->"ec0b91e3-6ca1-4640-9476-f0b31b3d8e39"],
Cell[CellGroupData[{
Cell[44323, 922, 9760, 225, 713, "Input",ExpressionUUID->"deb2ecd5-9f8f-4441-8487-b8c35ece8332"],
Cell[54086, 1149, 1197, 29, 36, "Output",ExpressionUUID->"cffa9a46-587d-430d-80ce-5a09d909ca1e"]
}, Open  ]],
Cell[55298, 1181, 2243, 31, 28, "Input",ExpressionUUID->"b3cdb057-db3d-45f1-9c96-75d5e549057b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[57578, 1217, 273, 5, 67, "Section",ExpressionUUID->"57d376b7-709c-4382-b9f0-e7ed18910f9a"],
Cell[CellGroupData[{
Cell[57876, 1226, 6422, 135, 675, "Input",ExpressionUUID->"f3c8b13d-1901-4ba5-a59d-766bc8143702"],
Cell[CellGroupData[{
Cell[64323, 1365, 1299, 32, 28, "Print",ExpressionUUID->"47da9ca8-6c4d-4611-b2f6-771714ffeb6a"],
Cell[65625, 1399, 601, 11, 22, "Print",ExpressionUUID->"538cc410-583e-4679-9a07-f00d377f3dac"],
Cell[66229, 1412, 983, 20, 22, "Print",ExpressionUUID->"a7d36572-7b03-40dd-aaa2-19ac0054d7de"],
Cell[67215, 1434, 1227, 30, 35, "Print",ExpressionUUID->"af1aeb35-c992-47e6-8d74-64fdba9feafb"],
Cell[68445, 1466, 1047, 22, 24, "Print",ExpressionUUID->"49442b65-e7f4-4063-ad9a-5fdaefd629a6"],
Cell[69495, 1490, 1311, 32, 41, "Print",ExpressionUUID->"0e5a292f-16dc-4214-ba0b-14b4c5da2d61"],
Cell[70809, 1524, 1030, 21, 24, "Print",ExpressionUUID->"dff83325-e690-43c8-9101-c1d563c052b5"],
Cell[71842, 1547, 1269, 30, 41, "Print",ExpressionUUID->"c8124171-2890-4447-933d-6eec6cef6a51"],
Cell[73114, 1579, 1034, 22, 24, "Print",ExpressionUUID->"9f132c33-68bd-44da-946b-d7d9d031b0d1"],
Cell[74151, 1603, 1268, 30, 41, "Print",ExpressionUUID->"a6b9cdb1-9b08-4558-92ab-c7e4cc8e1bb7"]
}, Open  ]]
}, Open  ]],
Cell[75446, 1637, 207, 4, 28, "Input",ExpressionUUID->"f2e83408-d9e5-425b-b268-3c0bf8b60cbb"],
Cell[75656, 1643, 205, 4, 28, "Input",ExpressionUUID->"31b581fe-5ef1-477a-8f08-10fc7dbfc5ed"],
Cell[75864, 1649, 4152, 94, 409, "Input",ExpressionUUID->"3a0a429a-b833-471e-8b48-19144756747e"]
}, Open  ]]
}, Open  ]]
}
]
*)

